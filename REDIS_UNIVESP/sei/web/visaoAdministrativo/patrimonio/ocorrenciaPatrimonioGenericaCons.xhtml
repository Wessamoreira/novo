<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:a4j="http://richfaces.org/a4j" xmlns:rich="http://richfaces.org/rich" xmlns:otm="http://java.sun.com/jsf/composite/otm">
<f:loadBundle var="msg_bt" basename="propriedades.Botoes" />
<f:loadBundle var="msg_aplic" basename="propriedades.Aplicacao" />
<f:loadBundle var="msg" basename="propriedades.Mensagens" />
<h:form id="form">
	<h:commandLink action="#{OcorrenciaPatrimonioControle.liberarBackingBeanMemoria}" immediate="true" id="idLiberarBackingBeanMemoria" style="display: none" />
	<h:panelGroup layout="block" styleClass="col-md-2" rendered="#{!(OcorrenciaPatrimonioControle.isVisaoCoordenador or OcorrenciaPatrimonioControle.isVisaoProfessor)}">
		<h:outputText styleClass="field control-label tituloCampos" value="#{msg.msg_consultar_por}" rendered="#{!(OcorrenciaPatrimonioControle.isVisaoCoordenador or OcorrenciaPatrimonioControle.isVisaoProfessor)}" />
		<h:selectOneMenu styleClass="form-control camposObrigatorios" id="consulta" required="true" value="#{OcorrenciaPatrimonioControle.controleConsultaOtimizado.campoConsulta}">
			<a4j:ajax event="change" render="tipoOcorrencia" />
			<f:selectItems value="#{OcorrenciaPatrimonioControle.listaSelectItemOpcaoConsulta}" />
		</h:selectOneMenu>
	</h:panelGroup>
	<h:panelGroup layout="block" styleClass="col-md-4 pt4" rendered="#{!(OcorrenciaPatrimonioControle.isVisaoCoordenador or OcorrenciaPatrimonioControle.isVisaoProfessor)}">
		<otm:spacer width="100%"></otm:spacer>
		<h:inputText id="valorConsulta" styleClass="form-control campos" value="#{OcorrenciaPatrimonioControle.controleConsultaOtimizado.valorConsulta}" />
	</h:panelGroup>
	<h:panelGroup layout="block" styleClass="#{!(OcorrenciaPatrimonioControle.isVisaoCoordenador or OcorrenciaPatrimonioControle.isVisaoProfessor) ? 'col-md-2' : 'col-md-4'}">
		<h:outputText styleClass="field control-label tituloCampos" value="#{msg_aplic.prt_OcorrenciaPatrimonio_tipoOcorrencia}" />
		<h:selectOneMenu styleClass="form-control camposObrigatorios" id="tipoOcorrencia" value="#{OcorrenciaPatrimonioControle.tipoOcorrenciaPatrimonioCons}">
			<f:selectItems value="#{OcorrenciaPatrimonioControle.listaSelectItemTipoOcorrenciaPatrimonio}" />
		</h:selectOneMenu>
	</h:panelGroup>
	<h:panelGroup layout="block" styleClass="col-md-2">
		<h:outputText styleClass="field control-label tituloCampos" value="#{msg_aplic.prt_OcorrenciaPatrimonio_periodoDe}" />
		<h:panelGroup layout="block" styleClass="col-md-12 pn h36">
			<otm:calendar id="valorConsultaDataInicio" value="#{OcorrenciaPatrimonioControle.controleConsultaOtimizado.dataIni}" />
		</h:panelGroup>
	</h:panelGroup>
	<h:panelGroup layout="block" styleClass="col-md-2">
		<h:outputText styleClass="field control-label tituloCampos" value=" Periodo Fim " />
		<h:panelGroup layout="block" styleClass="col-md-12 pn h36">
			<otm:calendar id="valorConsultaDataFim" value="#{OcorrenciaPatrimonioControle.controleConsultaOtimizado.dataFim}" />
		</h:panelGroup>
	</h:panelGroup>
	<h:panelGroup layout="block" styleClass="#{!(OcorrenciaPatrimonioControle.isVisaoCoordenador or OcorrenciaPatrimonioControle.isVisaoProfessor) ? 'col-md-12 text-center m10' : 'col-md-2 pt4'}">
		<otm:spacer width="100%" rendered="#{(OcorrenciaPatrimonioControle.isVisaoCoordenador or OcorrenciaPatrimonioControle.isVisaoProfessor)}"/>
		<a4j:commandLink id="consultar" render="form" action="#{OcorrenciaPatrimonioControle.consultarDados}" accesskey="2" value="#{msg_botoes.btn_consultar}" styleClass="btn btn-default btn-consultar">
			<span class="fa fa-search pull-left" style="margin-right: 0.8em; position: relative; top: 3px; font-size: 14px;"></span>
			<f:setPropertyActionListener target="#{OcorrenciaPatrimonioControle.controleConsultaOtimizado.paginaAtual}" value="1" />
			<f:setPropertyActionListener target="#{OcorrenciaPatrimonioControle.controleConsultaOtimizado.page}" value="1" />
		</a4j:commandLink>
	</h:panelGroup>
	<h:panelGroup layout="block" styleClass="barraFlutuanteInferior">
		<otm:commandButton style="margin-left: 5px" id="novo" action="#{OcorrenciaPatrimonioControle.novo}" value="#{msg_bt.btn_novo}" accesskey="1" styleClass="btn btn-info btn-novo" />
	</h:panelGroup>
	<rich:dataTable id="items" width="100%" headerClass="consulta" rowClasses="linhaImpar, linhaPar" columnClasses="colunaAlinhamento" value="#{OcorrenciaPatrimonioControle.controleConsultaOtimizado.listaConsulta}" rendered="#{OcorrenciaPatrimonioControle.controleConsultaOtimizado.apresentarListaConsulta}" rows="10" var="ocorrenciaPatrimonioCons">
		<rich:column>
			<f:facet name="header">
				<h:outputText value="#{msg_aplic.prt_UnidadeConteudo_tituloPagina}" />
			</f:facet>
			<h:commandLink action="#{OcorrenciaPatrimonioControle.editar}" id="unidadeEnsino" value="#{ocorrenciaPatrimonioCons.localArmazenamentoOrigem.unidadeEnsinoVO.nome}">
			</h:commandLink>
		</rich:column>
		<rich:column>
			<f:facet name="header">
				<h:outputText value="#{msg_aplic.prt_OcorrenciaPatrimonio_dataOcorrencia}" />
			</f:facet>
			<h:commandLink action="#{OcorrenciaPatrimonioControle.editar}" id="dataOcorrencia">
				<h:outputText value="#{ocorrenciaPatrimonioCons.dataOcorrencia}">
					<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
				</h:outputText>
			</h:commandLink>
		</rich:column>
		<rich:column>
			<f:facet name="header">
				<h:outputText value="#{msg_aplic.prt_OcorrenciaPatrimonio_tipoOcorrencia}" />
			</f:facet>
			<h:commandLink action="#{OcorrenciaPatrimonioControle.editar}" id="tipoOcorrenciaPatrimonio" value="#{ocorrenciaPatrimonioCons.tipoOcorrenciaPatrimonio.valorApresentar}" />
			<h:commandLink action="#{OcorrenciaPatrimonioControle.editar}" rendered="#{ocorrenciaPatrimonioCons.isTipoOcorrenciaEmprestimo}" id="solicitante" value=" (#{ocorrenciaPatrimonioCons.solicitanteEmprestimo.pessoa.nome})" />
		</rich:column>
		<rich:column>
			<f:facet name="header">
				<h:outputText value="#{msg_aplic.prt_OcorrenciaPatrimonio_patrimonio} / Local Reservado" />
			</f:facet>
			<h:commandLink action="#{OcorrenciaPatrimonioControle.editar}" id="patrimonio" rendered="#{!ocorrenciaPatrimonioCons.isApresentarDadosReservaLocal}" value="#{ocorrenciaPatrimonioCons.patrimonioUnidade.codigoBarra} - #{ocorrenciaPatrimonioCons.patrimonioUnidade.patrimonioVO.descricao}" />
			<h:commandLink action="#{OcorrenciaPatrimonioControle.editar}" id="localReservado" rendered="#{ocorrenciaPatrimonioCons.isApresentarDadosReservaLocal}" value="#{ocorrenciaPatrimonioCons.localReservado.localArmazenamento}" />
		</rich:column>
		<rich:column>
			<f:facet name="header">
				<h:outputText value="#{msg_aplic.prt_OcorrenciaPatrimonio_situacao}" />
			</f:facet>
			<h:commandLink action="#{OcorrenciaPatrimonioControle.editar}" id="situacao" value="#{ocorrenciaPatrimonioCons.situacao.valorApresentar}" />
			<h:commandLink action="#{OcorrenciaPatrimonioControle.editar}" rendered="#{ocorrenciaPatrimonioCons.isApresentarDataPrevisaoDevolucao and ocorrenciaPatrimonioCons.isEmAndamento}" id="dataPrevi" value=" (Prev. " />
			<h:commandLink action="#{OcorrenciaPatrimonioControle.editar}" rendered="#{ocorrenciaPatrimonioCons.isApresentarDataPrevisaoDevolucao and ocorrenciaPatrimonioCons.isEmAndamento}" id="dataPrevisao">
				<h:outputText value="#{ocorrenciaPatrimonioCons.dataPrevisaoDevolucao}">
					<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
				</h:outputText>
			</h:commandLink>
			<h:commandLink action="#{OcorrenciaPatrimonioControle.editar}" rendered="#{ocorrenciaPatrimonioCons.isApresentarDataPrevisaoDevolucao and ocorrenciaPatrimonioCons.isEmAndamento}" id="dataPreviFinal" value=")" />
		</rich:column>
		<rich:column>
			<f:facet name="header">
				<h:outputText value="#{msg_bt.btn_opcoes}" />
			</f:facet>
			<otm:commandIcon action="#{OcorrenciaPatrimonioControle.editar}" icon="#{msg_botoes.btn_icon_editar} iconePequeno" tooltip="Editar" />
		</rich:column>
		<f:facet name="footer">
			<div style="text-align: center !important">
				<rich:dataScroller align="center" for="items" id="paginador" stepControls="auto" fastControls="hide" boundaryControls="auto" page="#{OcorrenciaPatrimonioControle.controleConsultaOtimizado.page}" scrollListener="#{OcorrenciaPatrimonioControle.realizarPaginacaoConsulta}" rendered="#{OcorrenciaPatrimonioControle.controleConsultaOtimizado.apresentarPaginador}" />
			</div>
		</f:facet>
	</rich:dataTable>
	<h:panelGroup columns="1" width="100%" styleClass="tabMensagens">
		<h:panelGroup columns="1" width="100%" columnClasses="colunaEsquerda">
			<h:outputText styleClass="field control-label mensagem col-md-12" value="#{OcorrenciaPatrimonioControle.mensagem}" />
			<h:outputText styleClass="field control-label mensagemDetalhada col-md-12" value="#{OcorrenciaPatrimonioControle.mensagemDetalhada}" />
		</h:panelGroup>
	</h:panelGroup>
</h:form>
<script>
	document.getElementById("form:valorConsulta").focus();
</script>

</html>
