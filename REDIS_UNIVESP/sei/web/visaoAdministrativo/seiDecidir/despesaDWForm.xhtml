<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:a4j="http://richfaces.org/a4j" xmlns:rich="http://richfaces.org/rich" xmlns:otm="http://java.sun.com/jsf/composite/otm">

<f:loadBundle var="msg_bt" basename="propriedades.Botoes" />
<f:loadBundle var="msg_aplic" basename="propriedades.Aplicacao" />
<f:loadBundle var="msg" basename="propriedades.Mensagens" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" />
<meta http-equiv="Cache-Control" Content="no-cache" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<h:head>
	<h:outputStylesheet name="style.css" library="V2/css" />
	<h:outputStylesheet name="otimize2.css" library="css" />
	<h:outputStylesheet name="cssCliente.css" library="css" />
	<h:outputStylesheet name="colorpicker.css" library="css" />
	<h:outputScript name="jquery.js" library="V2/script" />
	<h:outputScript name="script.js" library="script" />
	<h:outputScript name="jquery.maskedinput.js" library="V2/script" />
	<h:outputScript name="jquery.maskMoney.js" library="V2/script" />
	<h:outputScript name="highcharts.js" library="script/highcharts" />
	<h:outputScript name="exporting.js" library="script/highcharts/modules" />
	<h:outputScript name="jquery.watermark.js" library="script" />
	<title><h:outputText value="#{LoginControle.versaoSistema}" /></title>
	<link rel="shortcut icon" href="#{resource['V2/icones/favicon.ico']}" type="image/x-icon" />
</h:head>

<ui:include src="modalPainelGestor.xhtml" />
<style type="text/css">
a:link {
	text-decoration: none;
}

a:visited {
	text-decoration: none;
}

a:hover {
	text-decoration: none;
	color: #f00;
}

a:active {
	text-decoration: none;
}
</style>

<title><h:outputText value="#{msg_menu.Menu_DespesaRequisicaoDW}" /></title>

<!--  	<a4j:status id="statusCarregandoModalTopo" onstart="Richfaces.showModalPanel('panelStatusCarregandoTopo')" onstop="Richfaces.hideModalPanel('panelStatusCarregandoTopo')" />  -->
<!--  	<rich:popupPanel styleClass="modalMaximizado" id="panelStatusCarregandoTopo" autosized="true"> > -->
<!--  		<h:panelGrid columns="2">  -->
<!--  			<h:graphicImage value="../imagens/ajax-loader.gif" />  -->
<!--  			<h:outputText styleClass="field control-label tituloCampos" value="Processando..." />  -->
<!--  		</h:panelGrid>  -->
<!--  	</rich:popupPanel>  -->
<ui:include src="/ajaxStatus.xhtml" />
<h:body style="background: url(#{resource['/imagens/bg1.jpg']}) fixed;">
	<h:form id="form">
		<div id="header" class="container cliente-bg">
			<div class="content">
				<ui:include src="/topo.xhtml" />

			</div>
		</div>
		<div id="header2" class="container">
			<div class="content">
				<img src="#{resource['V2/imagens/logo-painelgestor.png']}" alt="logo-painelgestor" width="242" height="48" />
			</div>
		</div>
		<!-- /header2 -->
		<div class="container">
			<div class="contentPainelGestor box clearfix">
				<div class="padding">
					<div class="container marginbottom">
						<h:panelGroup>
							<otm:spacer height="25px" />
							<h1 class="title1">Consumos</h1>
						</h:panelGroup>

						<h:panelGrid id="filtros" columnClasses="colunaEsquerda" headerClass="consulta" columns="1" width="100%">
							<h:panelGroup>
								<h:outputText styleClass="field control-label tituloCampos" value="#{msg_aplic.prt_PainelGestor_periodoDe}" />
								<otm:spacer width="10px" />
								<rich:calendar id="dataInicio" showWeekDaysBar="false" showWeeksBar="false" showFooter="false" locale="pt_BR" oninputkeypress="return mascara(this.form, this.id, '99/9999', event);" onchanged="return renderData(this.id)" oninputchange="validarDataMesAno(this.value,this.id)" enableManualInput="true" datePattern="MM/yyyy" inputClass="campos" inputSize="7" styleClass="form-control camposObrigatorios" value="#{DespesaDWControle.data}" />
								<h:outputText styleClass="field control-label tituloCampos" value="#{msg_aplic.prt_PainelGestor_ate}" />
								<otm:spacer width="30px" />
								<rich:calendar id="dataTermino" showWeekDaysBar="false" showWeeksBar="false" showFooter="false" locale="pt_BR" oninputkeypress="return mascara(this.form, this.id, '99/9999', event);" onchanged="return renderData(this.id)" oninputchange="validarDataMesAno(this.value,this.id)" enableManualInput="true" datePattern="MM/yyyy" inputClass="campos" inputSize="7" styleClass="form-control camposObrigatorios" value="#{DespesaDWControle.dataFim}" />
								<otm:spacer width="60px" />
								<otm:commandButton image="#{resource['/imagens/botaoGerarRelatorio2.png']}" oncomplete="criarGraficoConsumoNivel1()" styleClass="button1" style="position:relative; top:2px;" render="form" action="#{DespesaDWControle.gerarGraficos}" />
								<otm:spacer width="10px" />
<!-- 								<otm:commandButton image="#{resource['/imagens/voltar.png']}" styleClass="button1" immediate="true" style="position:relative; top:2px;" action="painelGestor.xhtml?faces-redirect=true" /> -->
							</h:panelGroup>
						</h:panelGrid>

					</div>

					<div class="container marginbottom" style="height: 450px">

						<h:panelGrid id="unidadeEnsino" rendered="#{DespesaDWControle.nivelGraficoDWVO1.apresentar and DespesaDWControle.nivelUnidade}" columns="1" width="100%" cellpadding="0" cellspacing="0">
							<otm:commandButton style="cursor:pointer;display:none" id="atualizarFiltro" render="form" />
							<h:panelGroup id="graficoConsumoNivelUnidadeEnsinoPie" style="display: inline-block; width: 100%; height: 260px; text-align: center;">
							</h:panelGroup>


							<script type="text/javascript" charset="UTF-8">
										(function($) {
											$.ajaxSetup({
												cache : false
											});

											$(document).ready(function() {
												criarGraficoConsumoNivel1();
											});

											selecionarLegendaGraficoConsumo = function(
													codigo, nome, valor, nivel) {
												$
														.ajax({
															type : "post",
															//dataType : "text",
															//data : codigo; nome; valor; nivel,
															url : "./grafico/pie/selecionarLegendaGraficoConsumo/"
																	+ codigo
																	+ "/"
																	+ nome
																	+ "/"
																	+ 0
																	+ "/"
																	+ nivel
																	+ ".wcs",
															contentType : "application/text;charset=UTF-8",
															success : function() {

																if (${DespesaDWControle.montarGraficoConsumoVisible} == false) {
																	alert("Você atingiu o último nível de consulta!");
																	return;
																}
																fireElement("form:atualizarFiltro1");
															}

														});
											};

											criarGraficoConsumoNivel1 = function() {

												var options = {
													exporting : {
														type : 'image/jpeg',
														buttons : {
															exportButton : {
																y : 5
															},
															printButton : {
																y : 5
															}
														}
													},
													chart : {
														type : "pie",
														renderTo : "form\:graficoConsumoNivelUnidadeEnsinoPie",
														backgroundColor : "#FFF",
														marginTop : 30,
														spacingLeft : 0,
														height : 290
													},
													credits : {
														enabled : false
													},
													title : {
														text : '<h1 style="width:830px;z-index:1;" class="title1">Quem?</h1>',
														align : 'left',
														useHTML : true,
														y : 5
													},
													plotOptions : {
														pie : {
															allowPointSelect : true,
															cursor : 'pointer',
															point : {
																events : {
																	click : function(
																			e) {
																		click: selecionarLegendaGraficoConsumo(
																				this.config[5],
																				this.config[0],
																				this.config[2],
																				this.config[4]);
																	},
																	legendItemClick : function(
																			e) {
																		click: selecionarLegendaGraficoConsumo(
																				this.config[5],
																				this.config[0],
																				this.config[2],
																				this.config[4])
																	}
																}
															},
															dataLabels : {
																enabled : false
															},
															showInLegend : true

														}
													},
													legend : {

														labelFormatter : function() {
															return this.name
																	+ ': <b>'
																	+ this.config[1]
																	+ '%</b>';
														},
														layout : 'vertical',
														align : 'right',
														verticalAlign : 'top',
														y : 50,
														x : -10,
														itemWidth : 400
													},
													tooltip : {
														formatter : function() {
															return '<b>'
																	+ this.point.name
																	+ ' - '
																	+ this.point.config[2]
																	+ '</b>: '
																	+ this.point.config[1]
																	+ '%';
														}
													},

													series : [ {
														visible : ${DespesaDWControle.montarGraficoConsumoVisible},
														data : [ ${DespesaDWControle.montarDataGraficoConsumo} ]
													} ]
												};
												var chart3 = new Highcharts.Chart(
														options);
											};

										}(jQuery));
									</script>
						</h:panelGrid>

						<h:panelGrid rendered="#{!DespesaDWControle.nivelUnidade}" columns="2" width="100%" cellpadding="0" cellspacing="4">


							<h:panelGrid rendered="#{DespesaDWControle.nivelGraficoDWVO1.apresentar}" id="departamento" columns="1" cellpadding="0" cellspacing="0">


								<h:panelGrid columns="2" width="100%">
									<h:panelGroup id="graficoConsumoNivelDepartamentoPie" style="display: inline-block; width: 350px; height: 440px; text-align: center;">
									</h:panelGroup>
									<h:panelGroup layout="block" style="position:relative;float:left; top: 40px;left:-60px;z-index:10" id="filtro1">
										<!--  									    <h1 class="title1" style="margin-top:5px">Navegação</h1>  -->
										<rich:dataTable style="display:inline-block;border:none;z-index:10" border="none" rowClasses="columnSemBorda" columnClasses="columnSemBorda" width="130px" rowKeyVar="row" value="#{DespesaDWControle.nivelGraficoDWVO1s}" var="filtro1Itens">
											<rich:column>

												<h:panelGroup>
													<a4j:commandLink styleClass="tituloCamposNavegacao" style="font-size:9px;" action="#{DespesaDWControle.voltarFiltro1}" render="form" value="#{row+1} - #{filtro1Itens.nomeEntidade}" />
												</h:panelGroup>
											</rich:column>
										</rich:dataTable>
									</h:panelGroup>
								</h:panelGrid>


								<otm:commandButton style="cursor:pointer;display:none" id="atualizarFiltro1" render="filtro1, graficoConsumoNivelDepartamentoPie" />

								<script type="text/javascript" charset="UTF-8">
											(function($) {
												$.ajaxSetup({
													cache : false
												});

												$(document)
														.ready(
																function() {
																	criarGraficoConsumoNivelDepartamento();
																});

												selecionarLegendaGraficoDepartamentoConsumo = function(
														codigo, nome, valor,
														nivel) {
													$
															.ajax({
																type : "post",
																//dataType : "text",
																//data : codigo; nome; valor; nivel,
																url : "./grafico/pie/selecionarLegendaGraficoDepartamentoConsumo/"
																		+ codigo
																		+ "/"
																		+ nome
																		+ "/"
																		+ 0
																		+ "/"
																		+ nivel
																		+ ".wcs",
																contentType : "application/text;charset=UTF-8",
																success : function() {

																	if (${DespesaDWControle.montarGraficoConsumoVisible} == false) {
																		alert("Você atingiu o último nível de consulta!");
																	} else {
																		fireElement("form:atualizarFiltro1");
																	}

																}

															});
												};

												criarGraficoConsumoNivelDepartamento = function() {

													var options = {
														exporting : {
															type : 'image/jpeg',
															buttons : {
																exportButton : {
																	y : 5
																},
																printButton : {
																	y : 5
																}
															}
														},
														chart : {
															type : "pie",
															renderTo : "form\:graficoConsumoNivelDepartamentoPie",
															backgroundColor : "#FFF",
															marginTop : 20,
															spacingLeft : 0,
															height : 400
														},
														credits : {
															enabled : false
														},
														title : {
															text : '<h1 style="width:290px;z-index:-1;" class="title1">Quem?</h1>',
															align : 'left',
															useHTML : true,
															y : 5
														},
														plotOptions : {
															pie : {
																allowPointSelect : true,
																cursor : 'pointer',
																point : {
																	events : {
																		click : function(
																				e) {
																			click: selecionarLegendaGraficoDepartamentoConsumo(
																					this.config[5],
																					this.config[0],
																					this.config[2],
																					this.config[4])
																		},
																		legendItemClick : function(
																				e) {
																			click: selecionarLegendaGraficoDepartamentoConsumo(
																					this.config[5],
																					this.config[0],
																					this.config[2],
																					this.config[4])
																		}
																	}
																},
																dataLabels : {
																	enabled : false
																},
																showInLegend : true

															}
														},
														legend : {

															labelFormatter : function() {
																return this.name
																		+ ': <b>'
																		+ this.config[1]
																		+ '%</b>';
															},
															layout : 'vertical',
															itemStyle : {
																position : 'relative',
																width : 320
															},
															x : 5,
															itemWidth : 330,
															maxHeight : 140
														},
														tooltip : {
															formatter : function() {
																return '<b>'
																		+ this.point.name
																		+ ' - '
																		+ this.point.config[2]
																		+ '</b>: '
																		+ this.point.config[1]
																		+ '%';
															}
														},

														series : [ {
															visible : ${DespesaDWControle.montarGraficoConsumoVisible},
															data : [ ${DespesaDWControle.montarDataGraficoConsumo} ]
														} ]
													};
													var chart3 = new Highcharts.Chart(
															options);
												};

											}(jQuery));
										</script>

							</h:panelGrid>




							<h:panelGrid rendered="#{DespesaDWControle.nivelGraficoDWVO2.apresentar}" columns="1" width="100%">

								<h:panelGrid columns="2" width="100%">
									<h:panelGroup id="graficoConsumoNivelComoPie" style="display: inline-block; width: 350px; height: 440px; text-align: center;">
									</h:panelGroup>
									<h:panelGroup layout="block" style="position:relative;float:left; top: 40px;left:-60px;z-index:1" id="filtro2">
										<!--  									    <h1 class="title1" style="margin-top:5px">Navegação</h1>  -->
										<rich:dataTable style="display:inline-block;border:none;z-index:10" border="none" rowClasses="columnSemBorda" columnClasses="columnSemBorda" width="130px" rowKeyVar="row" value="#{DespesaDWControle.nivelGraficoDWVO2s}" var="filtro2Itens">
											<rich:column>

												<h:panelGroup>
													<a4j:commandLink styleClass="tituloCamposNavegacao" style="font-size:9px;" action="#{DespesaDWControle.voltarFiltro2}" render="form" value="#{row+1} - #{filtro2Itens.nomeEntidade}" />
												</h:panelGroup>
											</rich:column>
										</rich:dataTable>
									</h:panelGroup>
								</h:panelGrid>
								<otm:commandButton style="cursor:pointer;display:none" id="atualizarFiltro2" render="filtro2, graficoConsumoNivelComoPie" />

								<script type="text/javascript" charset="UTF-8">
											(function($) {
												$.ajaxSetup({
													cache : false
												});

												$(document)
														.ready(
																function() {
																	criarGraficoConsumoNivelComo();
																});

												selecionarLegendaGraficoComoConsumo = function(
														codigo, nome, valor,
														nivel) {
													$
															.ajax({
																type : "post",
																//dataType : "text",
																//data : codigo; nome; valor; nivel,
																url : "./grafico/pie/selecionarLegendaGraficoComoConsumo/"
																		+ codigo
																		+ "/"
																		+ nome
																		+ "/"
																		+ 0
																		+ "/"
																		+ nivel
																		+ ".wcs",
																contentType : "application/text;charset=UTF-8",
																success : function() {
																	if (${DespesaDWControle.montarGraficoConsumoNivelDoisVisible} == false) {
																		alert("Você atingiu o último nível de consulta!");
																	} else {
																		fireElement("form:atualizarFiltro2");
																	}
																}
															});
												};

												criarGraficoConsumoNivelComo = function() {

													var options = {
														exporting : {
															type : 'image/jpeg',
															buttons : {
																exportButton : {
																	y : 5
																},
																printButton : {
																	y : 5
																}
															}
														},
														chart : {
															type : "pie",
															renderTo : "form\:graficoConsumoNivelComoPie",
															backgroundColor : "#FFF",
															marginTop : 20,
															spacingLeft : 0,
															height : 400
														},
														credits : {
															enabled : false
														},
														title : {
															text : '<h1 style="width:290px;z-index:1;" class="title1">Como?</h1>',
															align : 'left',
															useHTML : true,
															y : 5
														},
														plotOptions : {
															pie : {
																allowPointSelect : true,
																cursor : 'pointer',
																point : {
																	events : {
																		click : function(
																				e) {
																			click: selecionarLegendaGraficoComoConsumo(
																					this.config[5],
																					this.config[0],
																					this.config[2],
																					this.config[4]);
																		},
																		legendItemClick : function(
																				e) {
																			click: selecionarLegendaGraficoComoConsumo(
																					this.config[5],
																					this.config[0],
																					this.config[2],
																					this.config[4])
																		}
																	}
																},
																dataLabels : {
																	enabled : false
																},
																showInLegend : true,
																zIndex : 10000
															}
														},
														legend : {

															labelFormatter : function() {
																return this.name
																		+ ':<strong>'
																		+ this.config[1]
																		+ '%</strong>';
															},
															layout : 'vertical',
															verticalAlign : 'bottom',
															itemWidth : 330,
															maxHeight : 160,
															itemStyle : {
																position : 'relative',
																width : 320,

															},
															x : 5
														},
														tooltip : {
															formatter : function() {
																return '<div style="z-index:1000"><b>'
																		+ this.point.name
																		+ ' - '
																		+ this.point.config[2]
																		+ '</b>: '
																		+ this.point.config[1]
																		+ '%</div>'
															},

															style : {
																zIndex : 10000
															}
														//useHTML:true

														},

														series : [ {
															visible : ${DespesaDWControle.montarGraficoConsumoNivelDoisVisible},
															data : [ ${DespesaDWControle.montarDataGraficoConsumoNivelDois} ]
														} ]
													};
													var chart3 = new Highcharts.Chart(
															options);
												};

											}(jQuery));
										</script>

							</h:panelGrid>

						</h:panelGrid>
					</div>
				</div>
			</div>
			<!-- /content -->
		</div>
		<!-- /container -->
		<div id="footer" class="content"></div>
		<!-- 			<p:growl id="mensagem" globalOnly="true" /> -->
	</h:form>
</h:body>
</html>
