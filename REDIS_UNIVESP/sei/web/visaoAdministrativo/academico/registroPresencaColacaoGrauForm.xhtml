<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:a4j="http://richfaces.org/a4j" xmlns:rich="http://richfaces.org/rich" xmlns:otm="http://java.sun.com/jsf/composite/otm">
<h:head>
</h:head>
<ui:composition template="/visaoAdministrativo/template/visaoAdministrativa.xhtml">
	<ui:define name="tituloPagina">
		<h:outputText value="#{msg_aplic.prt_RegistroPresencaColacaoGrau_tituloForm}" />
	</ui:define>
	<ui:define name="conteudo">
		<title><h:outputText value="#{msg_aplic.prt_ProgramacaoFormatura_tituloForm}" /></title>
		<rich:popupPanel styleClass="modalMaximizado" id="panelProgramacaoFormatura" shadowOpacity="true" width="700" height="500" onshow="document.getElementById('formProgramacaoFormatura:valorConsulta').focus();">
			<f:facet name="header">
				<h:panelGroup>
					<h:outputText value="#{msg_aplic.prt_RegistroPresencaColacaoGrau_consultarProgramacaoFormaturaColacaoGrau}" />
				</h:panelGroup>
			</f:facet>
			<f:facet name="controls">
				<h:panelGroup>
					<h:graphicImage value="#{resource['imagens/close.png']}" styleClass="icon-close-modal" style="cursor:pointer" id="hiperlinkCurso" />
					<rich:componentControl target="panelProgramacaoFormatura" operation="hide" event="click" />
				</h:panelGroup>
			</f:facet>
			<h:form id="formProgramacaoFormatura">
				<h:panelGroup layout="block" styleClass="col-md-12">
					<h:outputText styleClass="field control-label tituloCampos" value="#{msg.msg_consultar_por}" />
				</h:panelGroup>
				<h:panelGroup layout="block" styleClass="col-md-4">
					<h:selectOneMenu styleClass="form-control campos" id="consulta" required="true" value="#{RegistroPresencaColacaoGrauControle.controleConsulta.campoConsulta}">
						<a4j:ajax event="change" listener="#{RegistroPresencaColacaoGrauControle.mostrarSegundoCampo}" render="formProgramacaoFormatura" />
						<f:selectItems value="#{RegistroPresencaColacaoGrauControle.tipoConsultaCombo}" />
					</h:selectOneMenu>
				</h:panelGroup>
				<h:panelGroup layout="block" styleClass="col-md-6" rendered="#{!RegistroPresencaColacaoGrauControle.mostrarSegundoCampo}">
					<h:inputText rendered="#{!RegistroPresencaColacaoGrauControle.mostrarSegundoCampo}" id="valorConsulta" styleClass="form-control campos" value="#{RegistroPresencaColacaoGrauControle.controleConsulta.valorConsulta}" />
				</h:panelGroup>
				<h:panelGroup id="datas" rendered="#{RegistroPresencaColacaoGrauControle.mostrarSegundoCampo}">
					<h:panelGroup layout="block" styleClass="col-md-3">
						<otm:calendar id="dataConsultaInicio" oninputkeypress="return mascara(this.form, this.id, '99/99/9999', event);" onchanged="return renderData(this.id)" oninputchange="validarData(this.value,this.id)" enableManualInput="true" datePattern="dd/MM/yyyy" value="#{RegistroPresencaColacaoGrauControle.valorConsultaDataInicio}" />
					</h:panelGroup>
					<h:panelGroup layout="block" styleClass="col-md-3">
						<otm:calendar id="dataConsultaFinal" oninputkeypress="return mascara(this.form, this.id, '99/99/9999', event);" onchanged="return renderData(this.id)" oninputchange="validarData(this.value,this.id)" enableManualInput="true" datePattern="dd/MM/yyyy" value="#{RegistroPresencaColacaoGrauControle.valorConsultaDataFinal}" />
						<h:message for="datas" styleClass="field control-label mensagemDetalhada col-md-12" />
					</h:panelGroup>
				</h:panelGroup>
				<h:panelGroup layout="block" styleClass="col-md-2">
					<otm:commandButton id="consultar" render="formProgramacaoFormatura" value="#{msg_botoes.btn_consultar}" action="#{RegistroPresencaColacaoGrauControle.consultar}" styleClass="btn btn-default btn-consultar" title="#{msg.msg_consultar_dados}" accesskey="2" />
				</h:panelGroup>
				<h:panelGroup layout="block" styleClass="col-md-12 mt5" />
				<rich:dataTable id="items" width="100%" headerClass="consulta" rowClasses="linhaImpar, linhaPar" columnClasses="colunaAlinhamento" value="#{RegistroPresencaColacaoGrauControle.listaConsulta}" rendered="#{RegistroPresencaColacaoGrauControle.apresentarResultadoConsulta}" rows="10" var="programacaoFormaturaItens">
					<rich:column>
						<f:facet name="header">
							<h:outputText value="#{msg_aplic.prt_ProgramacaoFormatura_codigo}" />
						</f:facet>
						<a4j:commandLink action="#{RegistroPresencaColacaoGrauControle.selecionarProgramacaoFormatura}" id="codigo" value="#{programacaoFormaturaItens.codigo}" oncomplete="#{rich:component('panelProgramacaoFormatura')}.hide()" render="form, programacaoFormaturaAlunoVO ,formProgramacaoFormatura" />
					</rich:column>
					<rich:column>
						<f:facet name="header">
							<h:outputText value="#{msg_aplic.prt_ProgramacaoFormatura_unidadeEnsino}" />
						</f:facet>
						<a4j:commandLink action="#{RegistroPresencaColacaoGrauControle.selecionarProgramacaoFormatura}" id="unidadeEnsino" value="#{programacaoFormaturaItens.unidadeConsultaApresentar}" oncomplete="#{rich:component('panelProgramacaoFormatura')}.hide()" render="form, programacaoFormaturaAlunoVO ,formProgramacaoFormatura" />
					</rich:column>
					<rich:column>
						<f:facet name="header">
							<h:outputText value="#{msg_aplic.prt_ProgramacaoFormatura_dataCadastro}" />
						</f:facet>
						<a4j:commandLink action="#{RegistroPresencaColacaoGrauControle.selecionarProgramacaoFormatura}" id="dataCadastro" value="#{programacaoFormaturaItens.dataCadastro_Apresentar}" oncomplete="#{rich:component('panelProgramacaoFormatura')}.hide()" render="form, programacaoFormaturaAlunoVO ,formProgramacaoFormatura" />
					</rich:column>
					<rich:column>
						<f:facet name="header">
							<h:outputText value="#{msg_aplic.prt_ProgramacaoFormatura_responsavelCadastro}" />
						</f:facet>
						<a4j:commandLink action="#{RegistroPresencaColacaoGrauControle.selecionarProgramacaoFormatura}" id="responsavelCadastro" value="#{programacaoFormaturaItens.responsavelCadastro.nome}" oncomplete="#{rich:component('panelProgramacaoFormatura')}.hide()" render="form, programacaoFormaturaAlunoVO ,formProgramacaoFormatura" />
					</rich:column>
					<rich:column>
						<f:facet name="header">
							<h:outputText value="#{msg_botoes.btn_opcoes}" />
						</f:facet>
						<otm:commandIcon action="#{RegistroPresencaColacaoGrauControle.selecionarProgramacaoFormatura}" icon="#{msg_botoes.btn_icon_selecionar} iconePequeno" title="#{msg.msg_editar_dados}" oncomplete="#{rich:component('panelProgramacaoFormatura')}.hide()" render="form, programacaoFormaturaAlunoVO ,formProgramacaoFormatura" />
					</rich:column>
					<f:facet name="footer">
						<div style="text-align: center !important">
							<rich:dataScroller align="center" for="formProgramacaoFormatura:items" id="scResultadoConsulta" rendered="#{RegistroPresencaColacaoGrauControle.apresentarResultadoConsulta}" boundaryControls="auto" stepControls="auto" fastControls="hide" />
						</div>
					</f:facet>
				</rich:dataTable>
				<h:panelGroup id="mensagemConsultaCurso" columns="1" width="100%" styleClass="tabMensagens">
					<otm:mensagem bean="#{RegistroPresencaColacaoGrauControle}"></otm:mensagem>
				</h:panelGroup>
			</h:form>
		</rich:popupPanel>
		
		<rich:popupPanel styleClass="modalMaximizado" id="panelAvisoDiplicidadeProgramacaoFormaturaAluno" show="#{RegistroPresencaColacaoGrauControle.apresentarModalProgramacaoFormatura}" shadowOpacity="true" width="700" height="500">
			<f:facet name="header">
				<h:outputText value="Aviso" />
			</f:facet>
			<h:form id="formAvisoDiplicidadeProgramacaoFormaturaAluno">
				<a4j:jsFunction name="oncompleteModalProgramacaoFormatura" oncomplete="#{RegistroPresencaColacaoGrauControle.oncompleteModal}" />
				<h:panelGroup layout="block" styleClass="col-md-12 border rounded bg-gray-100 p10 text-center mb10">
					<i class="#{msg_botoes.btn_icon_aviso_embutido} text-warning mr5 fs15" />
					<h:outputText styleClass="tituloCampos font-weight-bold" value="Existem programações de formatura com duplicidade. Nas matrículas a seguir, já existe uma programação de formatura em que o estudante COLOU GRAU ou esteja NÃO INFORMADA. Para salvar todas as alterações feitas na lista anterior, basta clicar no botão 'GRAVAR'. Nesse caso, serão salvos apenas os alunos que não possuem duplicidade" />
				</h:panelGroup>
				<h:panelGroup layout="block" styleClass="col-md-12 pn">
					<h:panelGroup layout="block" styleClass="col-md-12">
						<otm:outputHelp id="helpQtdReDupli" styleClassPanel="mr5" styleClass="tituloCampos" value="Quantidade de registros duplicados: " tooltip="A quantidade de registros com duplicidade de programação de formatura por aluno indica que, para efetuar a alteração das informações, é necessário excluir essa duplicidade ou utilizar a outra programação de formatura do aluno que já esteja com a situação de 'Colou Grau' ou 'Não Informado'" />
						<h:outputText styleClass="tituloCampos font-weight-bold" value="#{RegistroPresencaColacaoGrauControle.qtdProgramacaoFormaturaAlunoDuplicados}" />
					</h:panelGroup>
					<h:panelGroup layout="block" styleClass="col-md-12">
						<otm:outputHelp id="helpQtdReNaoDupli" styleClassPanel="mr5" styleClass="tituloCampos" value="Quantidade de registros não duplicados: " tooltip="Este número representa os registros sem duplicidade na programação de formatura por aluno. Ao clicar no botão 'GRAVAR', o sistema salvará as informações alteradas." />
						<h:outputText styleClass="tituloCampos font-weight-bold" value="#{RegistroPresencaColacaoGrauControle.qtdProgramacaoFormaturaAlunoNaoDuplicados}" />
					</h:panelGroup>
				</h:panelGroup>
				<rich:dataTable id="listaProgramcoesDuplicadas" value="#{RegistroPresencaColacaoGrauControle.programacaoFormaturaAlunoVOs}" var="programacaoAlunoItens" rows="8">
					<rich:column>
						<f:facet name="header">
							<h:outputText value="#{msg_aplic.prt_ProgramacaoFormaturaAluno_matricula}" />
						</f:facet>
						<h:outputText value="#{programacaoAlunoItens.matricula.matricula}" />
					</rich:column>
					<rich:column>
						<f:facet name="header">
							<h:outputText value="#{msg_aplic.prt_ProgramacaoFormaturaAluno_aluno}" />
						</f:facet>
						<h:outputText value="#{programacaoAlunoItens.matricula.aluno.nome}" />
					</rich:column>
					<rich:column>
						<f:facet name="header">
							<otm:outputHelp id="helpProgramacaoFormatura" value="Programação de formatura" tooltip="Programação de formatura encontrada que o aluno COLOU GRAU ou esteja NÃO INFORMADA" styleClass=" " />
						</f:facet>
						<h:outputText value="#{programacaoAlunoItens.programacaoFormaturaVO.codigo} - #{programacaoAlunoItens.programacaoFormaturaVO.colacaoGrauVO.titulo}" />
					</rich:column>
					<rich:column>
						<f:facet name="header">
							<h:outputText value="Opções" />
						</f:facet>
						<otm:commandIcon icon="#{msg_botoes.btn_icon_remover} iconePequeno" tooltip="Excluir aluno da programação de formatura de código #{programacaoAlunoItens.programacaoFormaturaVO.codigo}" action="#{RegistroPresencaColacaoGrauControle.excluirProgramacaoFormaturaAlunoDuplicada}" render="formAvisoDiplicidadeProgramacaoFormaturaAluno, form:programacaoFormaturaAlunoVO" oncomplete="oncompleteModalProgramacaoFormatura()" onclick="return confirm('Ao clicar para excluir, esse aluno será excluído da programação de formatura de código ' + #{programacaoAlunoItens.programacaoFormaturaVO.codigo});" />
					</rich:column>
					<f:facet name="footer">
						<rich:dataScroller for="listaProgramcoesDuplicadas" maxPages="10" />
					</f:facet>
				</rich:dataTable>
				<h:panelGroup layout="block" styleClass="row mn">
					<otm:mensagem bean="#{RegistroPresencaColacaoGrauControle}" />
				</h:panelGroup>
				<h:panelGroup layout="block" styleClass="barra-btn-flutuante-modal-80">
					<otm:commandButton value="fechar" styleClass="btn btn-danger" icon="#{msg_botoes.btn_icon_fechar_embutido}" action="#{RegistroPresencaColacaoGrauControle.setApresentarModalProgramacaoFormatura(null)}" oncomplete="#{rich:component('panelAvisoDiplicidadeProgramacaoFormaturaAluno')}.hide();" render="formAvisoDiplicidadeProgramacaoFormaturaAluno" />
					<otm:spacer width="5" />
					<otm:commandButton value="#{msg_botoes.btn_gravar}" styleClass="btn btn-dark btn-gravar" action="#{RegistroPresencaColacaoGrauControle.gravar}" title="#{msg.msg_gravar_dados}" accesskey="2" />
				</h:panelGroup>
			</h:form>
		</rich:popupPanel>

		<h:form id="form" oncomplete="#{RegistroPresencaColacaoGrauControle.novo}">
			<h:commandLink action="#{RegistroPresencaColacaoGrauControle.liberarBackingBeanMemoria}" id="idLiberarBackingBeanMemoria" style="display: none" />
			<h:panelGroup id="panelGridForm">
				<h:panelGroup layout="block" styleClass="col-md-12 text-center" style="margin:10px">
					<otm:commandButton id="listarAlunos" oncomplete="#{rich:component('panelProgramacaoFormatura')}.show()" styleClass="btn btn-default btn_icon_lista_embutido" value="Listar Aluno" icon="#{msg_botoes.btn_icon_lista_embutido}" title="#{msg.msg_atualizar_dados}" accesskey="2" render="programacaoFormaturaAlunoVO" />
				</h:panelGroup>
				<h:panelGroup columns="1" width="100%" styleClass="tabFormSubordinada">
					<rich:dataTable id="programacaoFormaturaAlunoVO" width="100%" headerClass="subordinado" styleClass="tabFormSubordinada" rowClasses="linhaImparSubordinado, linhaParSubordinado" columnClasses="colunaCentralizada" value="#{RegistroPresencaColacaoGrauControle.programacaoFormaturaVO.programacaoFormaturaAlunoVOs}" rows="10" var="programacaoFormaturaAlunoItens">
						<rich:column filterType="custom" filter="#{FilterFactory.filter('programacaoFormaturaAlunoVO', 'matricula.matricula', 'TEXTO')}">
							<f:facet name="header">
								<h:outputText value="#{msg_aplic.prt_ProgramacaoFormaturaAluno_matricula}" />
								<h:inputText styleClass="form-control campos" size="20" value="#{FilterFactory.filter('programacaoFormaturaAlunoVO', 'matricula.matricula', 'TEXTO').filtro}">
									<a4j:ajax event="change" execute="@this" render="programacaoFormaturaAlunoVO" />
								</h:inputText>
							</f:facet>
							<h:outputText value="#{programacaoFormaturaAlunoItens.matricula.matricula}" />
							<h:panelGroup rendered="#{programacaoFormaturaAlunoItens.existeProgramacaoFormaturaDuplicada}">
								<otm:commandIcon disabled="true" icon="#{msg_botoes.btn_icon_aviso_embutido} text-warning" styleClass="ml5 fs15" tooltip="Já existe uma programação de formatura para o aluno #{programacaoFormaturaAlunoItens.matricula.aluno.nome.toUpperCase()} cujo COLOU GRAU ou esteja NÃO INFORMADA" />
							</h:panelGroup>
						</rich:column>
						<rich:column filterType="custom" filter="#{FilterFactory.filter('programacaoFormaturaAlunoVO2', 'matricula.aluno.nome', 'TEXTO')}">
							<f:facet name="header">
								<h:outputText value="#{msg_aplic.prt_ProgramacaoFormaturaAluno_aluno}" />
								<h:inputText styleClass="form-control campos" size="20" value="#{FilterFactory.filter('programacaoFormaturaAlunoVO2', 'matricula.aluno.nome', 'TEXTO').filtro}">
									<a4j:ajax event="change" execute="@this" render="programacaoFormaturaAlunoVO" />
								</h:inputText>
							</f:facet>
							<h:outputText value="#{programacaoFormaturaAlunoItens.matricula.aluno.nome}" />
						</rich:column>
						<rich:column filterType="custom" filter="#{FilterFactory.filter('programacaoFormaturaAlunoVO3', 'matricula.curso.nome', 'TEXTO')}">
							<f:facet name="header">
								<h:outputText value="#{msg_aplic.prt_ProgramacaoFormaturaAluno_curso}" />
								<h:inputText styleClass="form-control campos" size="20" value="#{FilterFactory.filter('programacaoFormaturaAlunoVO3', 'matricula.curso.nome', 'TEXTO').filtro}">
									<a4j:ajax event="change" execute="@this" render="programacaoFormaturaAlunoVO" />
								</h:inputText>
							</f:facet>
							<h:outputText value="#{programacaoFormaturaAlunoItens.matricula.curso.nome}" />
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{msg_aplic.prt_ProgramacaoFormaturaAluno_dataColacao}" />
							</f:facet>
							<h:outputText value="#{programacaoFormaturaAlunoItens.colacaoGrau.tituloData}" />
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{msg_aplic.prt_ProgramacaoFormaturaAluno_curriculoIntegralizado}" />
							</f:facet>
							<otm:selectBooleanCheckbox disabled="true" value="#{programacaoFormaturaAlunoItens.curriculoIntegralizado}" style="margin: 0px !important;" />
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{msg_aplic.prt_ProgramacaoFormaturaAluno_colouGrau}" />
								<h:panelGroup layout="block" styleClass="col-md-12 pn">
									<h:selectOneMenu disabled="#{programacaoFormaturaAlunoItens.permitirAlterarSituacaoColouGrau}" styleClass="form-control campos" value="#{RegistroPresencaColacaoGrauControle.alunosColouGrau}">
										<f:selectItems value="#{RegistroPresencaColacaoGrauControle.listaAlunoColouGrau}" />
									</h:selectOneMenu>
									<span class="append-icon right mr10"> <otm:commandIcon tooltip="Marcar Todos Alunos" icon="#{msg_botoes.btn_icon_ordenar_embutido}" action="#{RegistroPresencaColacaoGrauControle.executarListarAlunosColouGrau}" render="form" />
									</span>
								</h:panelGroup>
							</f:facet>
							<h:selectOneMenu id="colacaoGrau" disabled="#{programacaoFormaturaAlunoItens.permitirAlterarSituacaoColouGrau || programacaoFormaturaAlunoItens.existeProgramacaoFormaturaDuplicada}" styleClass="form-control campos" value="#{programacaoFormaturaAlunoItens.colouGrau}">
								<f:selectItems value="#{RegistroPresencaColacaoGrauControle.listaColouGrau}" />
							</h:selectOneMenu>
						</rich:column>
						<f:facet name="footer">
							<div style="text-align: center !important">
								<rich:dataScroller align="center" for="form:programacaoFormaturaAlunoVO" id="scResultadoConsultaAlunos" rendered="#{RegistroPresencaColacaoGrauControle.apresentarAlunos}" boundaryControls="auto" stepControls="auto" fastControls="hide" />
							</div>
						</f:facet>
					</rich:dataTable>
					<h:panelGroup layout="block" styleClass="col-md-12 text-center mt5 mb5">
						<otm:commandButton render="form" action="#{RegistroPresencaColacaoGrauControle.realizarVerificacaoDocumentoAssinatura}" value="Atualizar Presença de Alunos Assinaram Ata Colação de Grau" icon="#{msg_botoes.btn_icon_signatureverifiy_embutido}" styleClass="btn btn-primary" rendered="#{RegistroPresencaColacaoGrauControle.apresentarBotaoAtualizarPresenca}" />
					</h:panelGroup>
				</h:panelGroup>
				<h:panelGroup columns="1" width="100%" styleClass="tabMensagens">
					<otm:mensagem bean="#{RegistroPresencaColacaoGrauControle}"></otm:mensagem>
					<h:panelGroup layout="block" styleClass="barraFlutuanteInferior">
						<h:panelGroup>
							<otm:commandButton id="novo" immediate="true" action="#{RegistroPresencaColacaoGrauControle.novo}" styleClass="btn btn-info btn-novo" value="#{msg_botoes.btn_novo}" title="#{msg.msg_novo_dados}" accesskey="1" />
							<otm:spacer width="5" />
							<otm:commandButton id="salvar" onclick="return confirm('#{msg.msg_ConfirmaGravacaoDados}');" action="#{RegistroPresencaColacaoGrauControle.incialiazarVerificacaoProgramacaoParaGravar}" value="#{msg_botoes.btn_gravar}" styleClass="btn btn-dark btn-gravar" title="#{msg.msg_gravar_dados}" oncomplete="#{RegistroPresencaColacaoGrauControle.oncompleteModal}" render="formAvisoDiplicidadeProgramacaoFormaturaAluno" accesskey="2" />
						</h:panelGroup>
					</h:panelGroup>
				</h:panelGroup>
			</h:panelGroup>
		</h:form>
	</ui:define>
</ui:composition>
</html>
