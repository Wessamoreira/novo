<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:pt="http://xmlns.jcp.org/jsf/passthrough" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:a4j="http://richfaces.org/a4j" xmlns:rich="http://richfaces.org/rich" xmlns:otm="http://java.sun.com/jsf/composite/otm" xmlns:otm2="http://www.otimize-ti.com.br">

	<ui:include src="login.xhtml"></ui:include>

	<rich:popupPanel id="panelTimeLine" styleClass="modalMaximizado100" autosized="true">
		<f:facet name="header">
			<h:panelGroup>
				<h:outputText value="Timeline" />
			</h:panelGroup>
		</f:facet>
		<f:facet name="controls">
			<h:panelGroup>
				<h:graphicImage value="#{resource['/imagens/minhaBiblioteca/Deletar.png']}" style="cursor:pointer; width: 16px;" id="hiperlinkpanelTimeLine" />
				<rich:componentControl target="panelTimeLine" operation="hide" event="click" />
			</h:panelGroup>
		</f:facet>
		<h:form id="formTimeLine">
			<h:panelGroup layout="block" styleClass="row" rendered="#{!empty MinhaBibliotecaControle.dadosTimeLineUsuario}">


				<otm:timeLine id="timeLineBib" values="#{MinhaBibliotecaControle.dadosTimeLineUsuario}" var="timeLineItem">
					<otm2:timeLineColumn styleClassPanel="bg-light">
						<ui:define name="iconTime">
							<h:panelGroup layout="block" styleClass="timeline-badge bg-light">
								<otm:commandIcon tooltip="#{timeLineItem.tipoOrigemTimeLine.valorApresentar}" icon="#{timeLineItem.tipoOrigemTimeLine.icon} fs25 mt10" styleIcon="#{timeLineItem.tipoOrigemTimeLine.styleIcon}" disabled="true">
								</otm:commandIcon>
							</h:panelGroup>
						</ui:define>
						<ui:define name="headerTime">
							<h:panelGroup class="row">

								<h:panelGroup layout="block" styleClass="float-left">
									<h:outputText styleClass="field control-label tituloCampos" value="#{timeLineItem.tipoOrigemTimeLine.valorApresentar}">
									</h:outputText>
								</h:panelGroup>
								<h:panelGroup layout="block" styleClass="float-right">
									<h:outputText styleClass="field control-label tituloCampos" value="#{timeLineItem.dataOcorrenciaApresentar}">
										<f:convertDateTime pattern="dd/MM/yyyy"></f:convertDateTime>
									</h:outputText>
								</h:panelGroup>
							</h:panelGroup>
						</ui:define>
						<ui:define name="bodyTime">
							<h:panelGroup layout="block" styleClass="col-md-12">
								<h:outputText styleClass="field control-label tituloCampos" value="Catálogo " />
								<h:outputText styleClass="field control-label pn col-md-12" value="#{timeLineItem.catalogo}" />
							</h:panelGroup>
							<h:panelGroup layout="block" styleClass="col-md-4" rendered="#{timeLineItem.tipoOrigemTimeLine eq 'EMPRESTIMO' or timeLineItem.tipoOrigemTimeLine eq 'EMPRESTIMO_RENOVADO'  or timeLineItem.tipoOrigemTimeLine eq 'EMPRESTIMO_ATRASADO'   or timeLineItem.tipoOrigemTimeLine eq 'EMPRESTIMO_DEVOLVIDO_EM_DIA'   or timeLineItem.tipoOrigemTimeLine eq 'EMPRESTIMO_DEVOLVIDO_ATRASADO'}">
								<h:outputText value="Data Previsão Devolução" styleClass="field control-label tituloCampos" />
								<h:outputText styleClass="field control-label pn col-md-12" value="#{timeLineItem.dataPrevDevolucao}">
									<f:convertDateTime pattern="dd/MM/yyyy"></f:convertDateTime>
								</h:outputText>
							</h:panelGroup>
							<h:panelGroup layout="block" styleClass="col-md-3" rendered="#{(timeLineItem.tipoOrigemTimeLine eq 'EMPRESTIMO' or timeLineItem.tipoOrigemTimeLine eq 'EMPRESTIMO_RENOVADO') and timeLineItem.dataDevolucao != null}">
								<h:outputText value="Data Devolução" styleClass="field control-label tituloCampos" />
								<h:outputText styleClass="field control-label pn col-md-12" value="#{timeLineItem.dataDevolucao}">
									<f:convertDateTime pattern="dd/MM/yyyy"></f:convertDateTime>
								</h:outputText>
							</h:panelGroup>
							<h:panelGroup layout="block" styleClass="col-md-3" rendered="#{(timeLineItem.tipoOrigemTimeLine eq 'EMPRESTIMO_EM_DIA' or timeLineItem.tipoOrigemTimeLine eq 'EMPRESTIMO_ATRASADO' or timeLineItem.tipoOrigemTimeLine eq 'EMPRESTIMO_RENOVADO'  or timeLineItem.tipoOrigemTimeLine eq 'EMPRESTIMO_DEVOLVIDO_EM_DIA' or timeLineItem.tipoOrigemTimeLine eq 'EMPRESTIMO_DEVOLVIDO_ATRASADO') and timeLineItem.dataEmprestimo != null}">
								<h:outputText value="Data Empréstimo" styleClass="field control-label tituloCampos" />
								<h:outputText styleClass="field control-label pn col-md-12" value="#{timeLineItem.dataEmprestimo}">
									<f:convertDateTime pattern="dd/MM/yyyy"></f:convertDateTime>
								</h:outputText>
							</h:panelGroup>
							<h:panelGroup layout="block" styleClass="col-md-2" rendered="#{(timeLineItem.tipoOrigemTimeLine eq 'EMPRESTIMO_DEVOLVIDO_ATRASADO' or timeLineItem.tipoOrigemTimeLine eq 'EMPRESTIMO_RENOVADO') and timeLineItem.valorMulta gt 0}">
								<h:outputText value="Valor Multa" styleClass="field control-label tituloCampos" />
								<h:outputText styleClass="field control-label pn col-md-12" value="#{timeLineItem.valorMulta}">
									<f:converter converterId="FormatadorNumerico"></f:converter>
								</h:outputText>
							</h:panelGroup>
							<h:panelGroup layout="block" styleClass="col-md-3" rendered="#{timeLineItem.tipoOrigemTimeLine eq 'CONTA_RECEBER_PAGAMENTO'}">
								<h:outputText value="Data Vencimento" styleClass="field control-label tituloCampos" />
								<h:outputText styleClass="field control-label pn col-md-12" value="#{timeLineItem.dataVencimentoContaReceber}">

								</h:outputText>
							</h:panelGroup>
							<h:panelGroup layout="block" styleClass="col-md-2" rendered="#{(timeLineItem.tipoOrigemTimeLine eq 'CONTA_RECEBER_VENCIMENTO' or timeLineItem.tipoOrigemTimeLine eq 'CONTA_RECEBER_PAGAMENTO')}">
								<h:outputText value="Valor Multa" styleClass="field control-label tituloCampos" />
								<h:outputText styleClass="field control-label pn col-md-12" value="#{timeLineItem.valorMulta}">
									<f:converter converterId="FormatadorNumerico"></f:converter>
								</h:outputText>
							</h:panelGroup>
							<h:panelGroup layout="block" styleClass="col-md-2" rendered="#{(timeLineItem.tipoOrigemTimeLine eq 'CONTA_RECEBER_VENCIMENTO' or timeLineItem.tipoOrigemTimeLine eq 'CONTA_RECEBER_PAGAMENTO') and ((timeLineItem.juro + timeLineItem.multa + timeLineItem.acrescimo) gt 0)}">
								<h:outputText value="Acréscimos" styleClass="field control-label tituloCampos" />
								<h:outputText styleClass="field control-label pn col-md-12" value="#{timeLineItem.juro + timeLineItem.multa + timeLineItem.acrescimo}">
									<f:converter converterId="FormatadorNumerico"></f:converter>
								</h:outputText>
							</h:panelGroup>
							<h:panelGroup layout="block" styleClass="col-md-2" rendered="#{(timeLineItem.tipoOrigemTimeLine eq 'CONTA_RECEBER_VENCIMENTO' or timeLineItem.tipoOrigemTimeLine eq 'CONTA_RECEBER_PAGAMENTO') and (timeLineItem.desconto gt 0)}">
								<h:outputText value="Desconto" styleClass="field control-label tituloCampos" />
								<h:outputText styleClass="field control-label pn col-md-12" value="#{timeLineItem.desconto}">
									<f:converter converterId="FormatadorNumerico"></f:converter>
								</h:outputText>
							</h:panelGroup>
							<h:panelGroup layout="block" styleClass="col-md-3" rendered="#{(timeLineItem.tipoOrigemTimeLine eq 'CONTA_RECEBER_VENCIMENTO' or timeLineItem.tipoOrigemTimeLine eq 'CONTA_RECEBER_PAGAMENTO') and timeLineItem.valorMulta != timeLineItem.valorRecebido}">
								<h:outputText value="Valor Recebido" rendered="#{timeLineItem.dataRecebimentoContaReceber != null and !empty timeLineItem.dataRecebimentoContaReceber}" styleClass="field control-label tituloCampos" />
								<h:outputText value="Valor Receber" rendered="#{timeLineItem.dataRecebimentoContaReceber == null or empty timeLineItem.dataRecebimentoContaReceber}" styleClass="field control-label tituloCampos" />
								<h:outputText styleClass="field control-label pn col-md-12" value="#{timeLineItem.valorRecebido}">
									<f:converter converterId="FormatadorNumerico"></f:converter>
								</h:outputText>
							</h:panelGroup>
							<h:panelGroup layout="block" styleClass="col-md-3" rendered="#{timeLineItem.tipoOrigemTimeLine eq 'CONTA_RECEBER_VENCIMENTO' and !empty timeLineItem.dataRecebimentoContaReceber}">
								<h:outputText value="Data Recebimento" styleClass="field control-label tituloCampos" />
								<h:outputText styleClass="field control-label pn col-md-12" value="#{timeLineItem.dataRecebimentoContaReceber}">

								</h:outputText>
							</h:panelGroup>
						</ui:define>
					</otm2:timeLineColumn>

				</otm:timeLine>

			</h:panelGroup>
			<h:panelGroup layout="block" styleClass="row" rendered="#{empty MinhaBibliotecaControle.dadosTimeLineUsuario}">
				<h:outputText value="Não Existe Informações da Timeline Para Usuário #{MinhaBibliotecaControle.usuarioLogado.nome}" styleClass="tituloCampos btn-block fs20 mt20 text-center" />
			</h:panelGroup>


			

		</h:form>
	</rich:popupPanel>


	<h:form id="formTopoBiblioteca" prependId="false" styleClass="w-100">
		<!-- Header  -->
		<a4j:jsFunction name="fecharMenuTop" render="subMenuId, menuAdm, menuAcad, menuFinan, menuCompra, menuEstagio, menuBI, menuProcSel, menuBib, menuPatr, menuCRM, menuAvalInst, menuCurr, menuPlano, menuNFE, menuRec, menuEad" status="menuSts" action="#{LoginControle.visualizarMenu('TODOS')}"></a4j:jsFunction>

		<div class="d-sm-inline-block w-100" style="height: 50px;">


			<a4j:commandLink id="sidebarToggleTop" onclick="fecharMenuTop()" styleClass="btn btn-link d-md-none rounded-circle mt10 fonteTopo" style="float: left; height: 50px;">
				<i class="fa fa-bars text-dark " style="font-size: 1.2rem"></i>
			</a4j:commandLink>

			<h:panelGroup id="box-user-total" style="float: left; height: 50px;">
				<h:panelGroup id="box-user" style="float: left;height: 50px;">
					<h:graphicImage styleClass="foto-topo-visao" rendered="#{!empty LoginControle.caminhoFotoUsuario }" value="#{LoginControle.caminhoFotoUsuario}" />
					<h:panelGroup rendered="#{empty LoginControle.caminhoFotoUsuario }" styleClass="fa fa-fw fa-user fonteTopo foto-topo-visao">
					</h:panelGroup>
				</h:panelGroup>
				<h:panelGroup styleClass="label-topo-visao" style="height:50px">
					<h:outputText rendered="#{LoginControle.usuarioLogado.codigo ne 0}" styleClass="fields control-label btn-block fs16 ml-2 mt-2 fonteTopo" style="line-height: 20px;" value="Olá #{LoginControle.usuarioLogado.nome_Apresentar}" />

					<otm:commandIcon rendered="#{LoginControle.usuarioLogado.codigo eq 0}" styleClass="fields control-label btn-block fs16 ml-2 mt-2 fonteTopo" icon="fas fa-sign-in-alt fonteTopo pull-left mt5 mr5" value="Clique aqui para logar/registrar-se." style="line-height: 20px;" tooltip="Logar" action="#{LoginControle.limparMensagem}" oncomplete="#{rich:component('modalLogin')}.show()" render="formLogin">

					</otm:commandIcon>

					<a4j:commandLink rendered="#{LoginControle.usuarioLogado.codigo ne 0}" oncomplete="#{rich:component('alterarSenha')}.show()" render="formAlterarSenha" id="clink03AS">
						<i class="fas fa-key ml-2 mr-2 fs10 fonteTopo" style="line-height: 15px;"></i>
					</a4j:commandLink>
					
				</h:panelGroup>

				<div id="box-options-user" class="rounded backMenu close" style="position: fixed; top: 50px; max-width: 800px; width: auto; left: 5px; z-index: 300; padding: 10px; min-width: 250px; box-shadow: 3px 3px 3px 3px #5a5c69">
					<a4j:commandLink styleClass="fonteMenu btn-block" oncomplete="#{rich:component('alterarSenha')}.show()" action="#{LoginControle.limparMensagem}" render="formAlterarSenha" id="clink03AS2">
						<i class="fas fa-key  fonteMenu iconeMenu"></i>
						<span class="fonteMenu">Alterar Senha</span>
					</a4j:commandLink>
					
				</div>

			</h:panelGroup>


			<h:panelGroup style="float:right;height: 50px;">
				<h:graphicImage styleClass="logo-cliente-topo-visao mt10" url="#{LoginControle.urlLogoUnidadeEnsino}" />
			</h:panelGroup>
			<h:panelGroup style="float:right;height: 50px;" rendered="#{LoginControle.usuarioLogado.codigo ne 0}" styleClass="border-right">
				<a4j:commandLink styleClass="nav-link mt10 " style="height: 50px;" title="Sair" action="#{LoginControle.logout}">
					<i class="fas fa-sign-out-alt fonteTopo" style="font-size: 1.2rem"></i>
				</a4j:commandLink>
			</h:panelGroup>

			<h:panelGroup styleClass="iconeTopoMenuExpansivo">
				<a style="height: 50px; cursor: pointer" onclick="collapseIconeMenuTopo()"> <i class="fas fa-ellipsis-v" style="font-size: 1.2rem; margin-top: 18px"></i>
				</a>
			</h:panelGroup>
			<h:panelGroup id="box-icone-menu-topo" rendered="#{LoginControle.usuarioLogado.codigo ne 0}" styleClass="iconeTopoMenuAdm">

				<h:panelGroup style="float:right;height: 50px;">
					<h:panelGroup styleClass="mt10" style="height: 50px;">
						<a4j:commandLink status="entradastatus" render="panelCaixaEntrada" class="nav-link-icon mt10 fonteTopo iconMsg" style="height: 50px; cursor: pointer" onclick="collapseCaixaMensagem()">
							<i class="fas fa-envelope " id="iconMsg" style="font-size: 1.2rem"></i>
							<span class="text-alerta-contador">#{ComunicacaoInternaControle.qtdMensagemCaixaEntrada}</span>
						</a4j:commandLink>
					</h:panelGroup>

					<div id="box-options-email" class="rounded backMenu close" style="position: fixed; top: 50px; max-width: 800px; width: auto; right: 5px; z-index: 300; padding: 10px; min-width: 250px; box-shadow: 3px 3px 3px 3px #5a5c69; max-height: 400px; overflow: auto">
						<h:panelGroup layout="block" id="panelCaixaEntrada">
							<rich:list id="listaNovasMsgs" rendered="#{!empty ComunicacaoInternaControle.listaConsulta}" value="#{ComunicacaoInternaControle.listaConsulta}" var="comunicacaoInternaItem">
								<h:panelGroup layout="block" styleClass="w-100 p-2 ">
									<a4j:commandLink action="#{PainelGestorAdministrativoControle.editarComunicacaoInternaParaTelaConsulta}" oncomplete="abrirPopup('../../visaoAdministrativo/administrativo/comunicacaoInternaForm.xhtml', 'comunicacaoInternaCons', 930, 595);">
										<h:panelGroup layout="block" styleClass="w-100" style="line-height:20px">
											<h:outputText styleClass="fonteMenu iconeMenu fs10" value="#{comunicacaoInternaItem.assunto}"></h:outputText>

											<h:panelGroup layout="block" styleClass="w-100" style="line-height:20px">

												<h:outputText styleClass="fonteMenu iconeMenu fs8 pull-left" value="#{comunicacaoInternaItem.responsavel.nome}"></h:outputText>


												<h:outputText styleClass="fonteMenu iconeMenu fs8 pull-right" value="#{comunicacaoInternaItem.data_Apresentar}"></h:outputText>

											</h:panelGroup>
										</h:panelGroup>
									</a4j:commandLink>
								</h:panelGroup>
							</rich:list>
							<h:panelGroup layout="block" rendered="#{empty ComunicacaoInternaControle.listaConsulta}" styleClass="w-100 text-center mt20 mb20 p-2 ">
								<h:outputText styleClass="fonteMenu iconeMenu fs10" value="VOCÊ NÃO POSSUI MENSAGENS NÃO LIDAS"></h:outputText>
							</h:panelGroup>
							<h:panelGroup layout="block" styleClass="w-100 text-center mt20 border-top ">
								<a4j:commandLink value="Acessar Caixa Entrada" styleClass="nav-link w-100" action="#{LoginControle.removerControleMemoriaFlashTela('ComunicacaoInternaControle')}" oncomplete="abrirPopup('../../visaoAdministrativo/administrativo/comunicacaoInternaCons.xhtml', 'comunicacaoInternaCons', 930, 595);">
									<i class="fas fa-envelope  fonteMenu pull-left fs14"></i>
								</a4j:commandLink>
							</h:panelGroup>
						</h:panelGroup>
					</div>
				</h:panelGroup>

				<h:panelGroup style="float:right;height: 50px;" rendered="#{LoginControle.usuarioLogado.codigo ne 0}">
					<a4j:commandLink styleClass="nav-link-icon mt10 fonteTopo iconTimeLine" style="height: 50px;" title="Histórico de Uso da Biblioteca" action="#{MinhaBibliotecaControle.montarDadosTimeLine}" render="formTimeLine" oncomplete="#{rich:component('panelTimeLine')}.show()">
						<i class="fas fa-project-diagram " id="iconTimeLine" style="font-size: 1.2rem"></i>
					</a4j:commandLink>
				</h:panelGroup>


			</h:panelGroup>

		</div>



	</h:form>
</ui:composition>