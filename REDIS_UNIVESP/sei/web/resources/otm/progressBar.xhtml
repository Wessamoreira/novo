<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
		
		<ui:component>
		<c:if test="#{empty id}">
			<c:set var="id" value="modalProgressBar"></c:set>
		</c:if>
				
		<c:if test="#{empty bar}">
			<c:set var="bar" value="progressBar"></c:set>
		</c:if>
		
		<c:if test="#{empty render}">
			<c:set var="render" value="form, modalProgressBarId"></c:set>
		</c:if>
		
		<c:if test="#{empty height}">
			<c:set var="height" value="66px"></c:set>
		</c:if>
		
		<c:if test="#{empty left}">
			<c:set var="left" value="25%"></c:set>
		</c:if>
		<c:if test="#{empty width}">
			<c:set var="width" value="350"></c:set>
		</c:if>
		<c:if test="#{empty top}">
			<c:set var="top" value="50%"></c:set>
		</c:if>
		
		<c:if test="#{empty interval}">
			<c:set var="interval" value="500"></c:set>
		</c:if>
		
		<c:if test="#{empty modal}">
			<c:set var="modal" value="true"></c:set>
		</c:if>	
		
		<style>
			.progress-bg {
				background: -webkit-gradient(linear, left top, left bottom, color-stop(0, #F2F2F2), color-stop(1, #CCCCCC)) !important;
    			background: #F2F2F2;filter:progid:DXImageTransform.Microsoft.Gradient(startColorStr='#F2F2F2',endColorStr='#CCCCCC',gradientType='0');
    		background: -moz-linear-gradient(bottom, #F2F2F2 0%, #CCCCCC 100%); 
			}
		</style>
				<style>
					.rf-pb-rmng{
						width:96% !important;
						height: 25px  !important;
					}
				</style>
		
		
		<a4j:region id="#{id}_region">
		<h:form id="#{id}" rendered="#{modal}" >
				<a4j:jsFunction id="#{id}_oncomplete2" name="executarOncomplete2" execute="@form" render="#{id}, #{render}" oncomplete="#{oncomplete}" />
				<a4j:jsFunction id="#{id}_oncomplete" name="executarOncomplete" status="#{id}" execute="@this" render="#{id}" oncomplete="#{bean[bar].ativado} ? '' : executarOncomplete2()" />
				<a4j:jsFunction id="#{id}_encerrar" name="encerrarProgressBar" status="#{id}" action="#{bean[bar].encerrar}" execute="@this" render="#{id}" oncomplete="executarOncomplete()" />
			<h:panelGroup id="#{id}_panel" rendered="#{bean[bar].pollAtivado}" style="position:fixed;width:100%;height:100%; background-color:transparent;z-index:5005;float:left;top:0;left:0" >
				<h:panelGroup id="#{id}_shadow" rendered="#{bean[bar].pollAtivado}" style="position:fixed;background-color:#CCCCCC; opacity:0.6; z-index:5005;width:100%;height:100%;float:left;top:0;left:0" >
				</h:panelGroup>
				<h:panelGroup id="#{id}_container" rendered="#{bean[bar].pollAtivado}" style="position:absolute;top:#{top}; left:10%;background-color:#FFFFFF;z-index:5005;width:calc(80vw);height:#{height};" >							
					
					<a4j:poll id="#{id}_pool1" interval="#{interval}" rendered="#{!bean[bar].assincrono and bean[bar].pollAtivado}" 
					enabled="#{!bean[bar].assincrono and bean[bar].pollAtivado}" status="#{id}" 
					execute="@this" action="#{bean[action]}" render="#{id}_pool1" 
					oncomplete="encerrarProgressBar()">
					
					</a4j:poll>	
					
					<a4j:poll id="#{id}_pool2" interval="#{interval}" rendered="#{bean[bar].assincrono and bean[bar].pollAtivado}" 
					enabled="#{bean[bar].assincrono and bean[bar].pollAtivado}" status="#{id}"
					execute="@this" action="#{bean[bar].iniciarAssincrono}"	render="#{id}"				
					oncomplete="encerrarProgressBar()">
					
					</a4j:poll>
					
						<h:panelGroup id="#{id}_progresso" rendered="#{bean[bar].pollAtivado}" layout="block" style="background-color:transparent; height:25px; margin-left:10px; position:relative; top:20px; width:98%; float:left; border:1px solid #C4C0C9" >
							<h:panelGroup layout="block" styleClass="progress-bg" style="min-height:25px;  height:25px !important; position:relative; width:#{bean[bar].porcentagem}% !important; float:left !important;" >
							</h:panelGroup>
							<h:outputText id="label#{id}" styleClass="field control-label tituloCampos" style="display:block; width:100%; position:relative; top:-25px; text-align:center;float:left;" 
							value="#{bean[bar].status}" />
						</h:panelGroup>
						<ui:insert name="botoesADDProgressBar">
						
						</ui:insert>
			
			</h:panelGroup>	
		</h:panelGroup>
		
		</h:form>	
			
		<h:panelGroup id="#{id}_container2" rendered="#{!modal and item.pollAtivado}" style="width:294px;height:24px;" >
									
					<a4j:jsFunction id="#{id}_oncomplete4" name="executarOncompleteTableMode2" execute="@this" render="#{render}" oncomplete="#{oncomplete}" />
					<a4j:jsFunction id="#{id}_oncomplete3" name="executarOncompleteTableMode" status="#{id}_container2" execute="@this" render="#{render}" oncomplete="#{item.ativado} ? '' : executarOncompleteTableMode2()" />
					<a4j:jsFunction id="#{id}_encerrar2" name="encerrarProgressBarTableMode" status="#{id}_container2" action="#{item.encerrar}" execute="@this" render="#{render}" oncomplete="executarOncompleteTableMode()" />
					<a4j:poll id="#{id}_pool3" interval="#{interval}" rendered="#{!item.assincrono and item.pollAtivado}" 
					enabled="#{!item.assincrono and item.pollAtivado}" status="#{id}_container2"
					execute="@this" action="#{bean[action]}" 
					oncomplete="encerrarProgressBarTableMode()">
					
					</a4j:poll>	
					
					<a4j:poll id="#{id}_pool4" interval="#{interval}" rendered="#{item.assincrono and item.pollAtivado}" 
					enabled="#{item.assincrono and item.pollAtivado}" status="#{id}_container2"
					execute="@this" action="#{item.iniciarAssincrono}"					
					oncomplete="encerrarProgressBarTableMode2()">
					
					</a4j:poll>
					
						<h:panelGroup id="#{id}_progresso1" layout="block" style="background-color:transparent; height:25px; margin-left:10px; width:270px; float:left; border:1px solid #C4C0C9" >
							<h:panelGroup layout="block" styleClass="progress-bg" style="height:25px !important; position:relative; width:#{item.porcentagem}% !important; float:left !important;" >
							<h:outputText id="label#{id}TableMode" styleClass="field control-label tituloCampos" style="display:block; width:270px; position:relative; top:2px; text-align:center;float:left;" 
							value="#{item.status}" />
							</h:panelGroup>
						</h:panelGroup>
				
			
			</h:panelGroup>	
			</a4j:region>
		
		</ui:component>		
	</html>
