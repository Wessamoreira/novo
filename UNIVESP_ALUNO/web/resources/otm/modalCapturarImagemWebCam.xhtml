<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:p="http://primefaces.org/ui" xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:otm="http://java.sun.com/jsf/composite/otm" xmlns:otm2="http://www.otimize-ti.com.br" >

<ui:component>

		<c:if test="#{empty id}">
			<c:set var="id" value="modalCapturarImagemWebCam"></c:set>
		</c:if>
		<c:if test="#{empty panelArquivo}">
			<c:set var="panelArquivo" value="panelImagem"></c:set>
		</c:if>
		<c:if test="#{empty formArquivo}">
			<c:set var="formArquivo" value="formImagem"></c:set>
		</c:if>
		<c:if test="#{empty mycamera}">
			<c:set var="mycamera" value="my_camera"></c:set>
		</c:if>
	<p:dialog hideEffect="fade" closeOnEscape="true" onHide="hideWebCamAPP();" closable="true" showEffect="fade" modal="true" draggable="false" onShow="showWebCamAPP('#{mycamera}');"  styleClass="modalMaximizado" id="#{id}" widgetVar="#{id}" >
			<f:facet name="header">
				<h:panelGroup>
					<h:outputText value="#{msg_aplic.prt_Disciplina_tirarFoto}" />
				</h:panelGroup>
			</f:facet>
			<h:form id="#{id}formWebCam">
				<h:outputScript name="script/webcam/webcam.js" />
				<h:outputScript name="script/script.js" />

				<h:commandButton id="#{id}cameraErrorTrue" action="#{bean.setCameraError(true)}" style="display:none">
					<p:ajax execute="@this" update="#{id}panelBotoes" />
				</h:commandButton>
				<h:commandButton id="#{id}cameraErrorFalse" action="#{bean.setCameraError(false)}" style="display:none" >
					<p:ajax execute="@this" update="#{id}panelBotoes" />
				</h:commandButton>

				<h:panelGroup layout="block" styleClass="row text-center">
					<div id="#{mycamera}" style="width: 320px; height: 240px; text-align: center"></div>
				</h:panelGroup>
				<br />
				<br />

				<h:panelGroup id="#{id}panelBotoes" layout="block" styleClass="barra-btn-flutuante-modal-80">
					<h:panelGroup rendered="#{!bean.cameraError}">
						<p:commandLink id="#{id}capturarFoto" value="Tirar Foto" style="margin-left:10px" styleClass="btn btn-primary" action="#{bean.executarCapturarFotoWebCam}"   update="#{id}panelBotoes"  oncomplete="take_snapshot('#{request.contextPath}/UploadServlet');"  rendered="#{bean.exibirBotaoTirarFoto}">
							<span class="fa fa-camera" style="margin-right: 0.5em;"></span>
						</p:commandLink>
						<p:commandLink id="#{id}novarFoto" value="Nova Foto" type="submit" style="margin-left:10px" styleClass="btn btn-dark"  update="#{formArquivo} foto2 #{id}panelBotoes"  oncomplete="Webcam.unfreeze();" action="#{bean.resetarCapturaFotoWebCam}" accesskey="2" >
							<span class="fa fa-camera" style="margin-right: 0.5em;"></span>
						</p:commandLink>
						<p:commandLink id="#{id}gravarFoto" value="Gravar" type="submit" style="margin-left:10px" styleClass="btn btn-info btn-gravar"  update="#{formArquivo} foto2"  oncomplete="PF('#{id}').hide(); PF('#{panelArquivo}').show();" accesskey="2" >
							<span class="fa fa-save" style="margin-right: 0.5em;"></span>
						</p:commandLink>
					</h:panelGroup>
					<h:panelGroup rendered="#{bean.cameraError}">
						<h:outputText value="Ocorreu um erro ao tentar acessar sua WebCam." style="color:red" />
					</h:panelGroup>
				</h:panelGroup>
				<br />
				<h:panelGroup layout="block" styleClass="row mt10">
					<h:outputText styleClass="field control-label tituloCampos col-md-12" value="* Verifique se as permissões para utilização da webcam estão liberadas." />
					<h:outputText styleClass="field control-label tituloCampos  col-md-12" value="* Dispositivos de câmera só funcionam em domínios seguros que utilizam o protocolo https." />
					<h:outputText styleClass="field control-label tituloCampos  col-md-12" value="* Verifique se os drivers do dispostivo estão devidamente instalados." />
				</h:panelGroup>
			</h:form>
		</p:dialog>
</ui:component>
</html>
