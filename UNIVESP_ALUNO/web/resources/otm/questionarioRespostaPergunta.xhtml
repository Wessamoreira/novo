<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:p="http://primefaces.org/ui" xmlns:h="http://java.sun.com/jsf/html" xmlns:ui="http://java.sun.com/jsf/facelets"  xmlns:f="http://java.sun.com/jsf/core"
 xmlns:c="http://java.sun.com/jsp/jstl/core"  xmlns:otm="http://java.sun.com/jsf/composite/otm" xmlns:otm2="http://www.otimize-ti.com.br">
<ui:component>
	<c:if test="#{empty disabled}">
		<c:set var="disabled" value="false"></c:set>
	</c:if>
	<c:if test="#{empty id}">
		<c:set var="id" value="questionarioResposta"></c:set>
	</c:if>
	<c:if test="#{empty renderedChecklist}">
		<c:set var="renderedChecklist" value="false"></c:set>
	</c:if>
	<c:if test="#{empty renderedAnexoPergunta}">
		<c:set var="renderedAnexoPergunta" value="false"></c:set>
	</c:if>
	<c:if test="#{empty desabilitarRespostaChecklist}">
		<c:set var="desabilitarRespostaChecklist" value="true"></c:set>
	</c:if>
	<c:if test="#{empty rowTextArea}">
		<c:set var="rowTextArea" value="5"></c:set>
	</c:if>
	<!--  	<c:if test="#{empty rendered}">  -->
	<!--  		<c:set var="rendered" value="#{!(disabled and perguntaItens.perguntaVO.tipoRespostaListaCampos)}"></c:set>  -->
	<!--  	</c:if>  -->
	<!-- 	prefixoPergunta -->
	<c:if test="#{empty rendered}">
		<c:set var="prefixoPergunta" value=""></c:set>
	</c:if>

	<p:dialog styleClass="modalMaximizado100" closeOnEscape="true" widgetVar="panelPreview" id="panelPreview" zindex="2000" shadowOpacity="false" width="400" height="200">
		<f:facet name="header">
			<h:panelGroup>
				<h:outputText styleClass="tituloCampos" value="Visualizar Arquivo" />
			</h:panelGroup>

		</f:facet>
			<h:panelGroup id="panelPreviewGeral" styleClass="row">
				<h:panelGroup layout="block" styleClass="col-md-12" rendered="#{bean.caminhoPreviewTipoPdf and bean.caminhoPreview != ''}">
					<otm2:pdfView2 bean="#{bean}" height="calc(100vh - 100px)" data="#{bean.caminhoPreview}" />
				</h:panelGroup>
				<h:panelGroup layout="block" styleClass="col-md-12" rendered="#{!bean.caminhoPreviewTipoPdf and bean.caminhoPreview != ''}">
					<h:graphicImage url="#{bean.caminhoPreview}" width="98%" />
				</h:panelGroup>
				<h:panelGroup layout="block" styleClass="barra-btn-flutuante-modal-100">
					<otm:commandButton id="fecharpanelPreview" title="#{msg_botoes.btn_fechar}" icon="#{msg_botoes.btn_icon_fechar_embutido}" value="Fechar" styleClass="btn btn-info" oncomplete="PF('panelPreview_' + row).hide();" />
				</h:panelGroup>
			</h:panelGroup>
	</p:dialog>
	<h:panelGroup id="panelDadosPergunta" rendered="#{rendered}">

		<h:panelGroup layout="block" styleClass="styleCampoDescricao" rendered="#{!perguntaItens.perguntaVO.tipoRespostaListaCampos and rendered}">
			<h:panelGroup layout="block" styleClass="panelDescricao">
				<otm:outputHelp escape="false" rendered="#{!empty perguntaItens.perguntaVO.orientacoesSobreCampo}" value="#{prefixoPergunta}#{perguntaItens.perguntaVO.descricao}" id="help1" tooltip="#{perguntaItens.perguntaVO.orientacoesSobreCampo}" styleClass="tituloPergunta"></otm:outputHelp>
				<h:outputText escape="false" rendered="#{empty perguntaItens.perguntaVO.orientacoesSobreCampo}" value="#{prefixoPergunta}#{perguntaItens.perguntaVO.descricao}" styleClass="tituloPergunta"></h:outputText>
			</h:panelGroup>
		</h:panelGroup>
		<h:panelGroup layout="block" styleClass="row p10 mt5 styleCampoDescricao panelDescricaoListaCampos" rendered="#{perguntaItens.perguntaVO.tipoRespostaListaCampos and rendered}">
			<h:panelGroup layout="block" styleClass="panelDescricao">
				<otm:outputHelp escape="false" rendered="#{!empty perguntaItens.perguntaVO.orientacoesSobreCampo}" value="#{prefixoPergunta}#{perguntaItens.perguntaVO.descricao}" id="help2" tooltip="#{perguntaItens.perguntaVO.orientacoesSobreCampo}" styleClass="tituloPergunta"></otm:outputHelp>
				<h:outputText escape="false" rendered="#{empty perguntaItens.perguntaVO.orientacoesSobreCampo}" value="#{prefixoPergunta}#{perguntaItens.perguntaVO.descricao}" styleClass="tituloPergunta"></h:outputText>
			</h:panelGroup>
		</h:panelGroup>
		<h:panelGroup layout="block" styleClass="#{perguntaItens.perguntaVO.tipoRespostaMultiplaEscolha or perguntaItens.perguntaVO.tipoRespostaSimplesEscolha ? 'panelSimplesMultiplas' : 'panelNaoSimplesMultiplas'} rowIcon">
			<p:fragment>
				<ui:repeat rendered="#{(perguntaItens.perguntaVO.tipoRespostaMultiplaEscolha or perguntaItens.perguntaVO.tipoRespostaSimplesEscolha) and perguntaItens.perguntaVO.layoutHorizontal and rendered}" id="#{id}_listaResposta" var="respostaItens" value="#{perguntaItens.respostaPerguntaRespostaOrigemVOs}">
					<h:panelGroup layout="block" styleClass="rowIcon p5 #{perguntaItens.perguntaVO.cssPergunta}">
						<h:panelGroup styleClass="panelBooleans">
							<p:commandLink id="#{id}_checkDes" rendered="#{perguntaItens.perguntaVO.tipoResposta eq 'ME'}" styleClass="mr5" disabled="#{disabled}" update="#{id}, panelDadosPergunta, #{id}_listaResposta, #{id}_checkDes" process="@this" action="#{bean.validarDadosListaResposta(perguntaItens, respostaItens)}">
								<h:panelGroup style="color: black;" styleClass="#{respostaItens.selecionado ? 'fas fa-check-square fs14 ': 'far fa-square fs14   '}"></h:panelGroup>
							</p:commandLink>
							<p:commandLink id="#{id}_checkMarc" rendered="#{perguntaItens.perguntaVO.tipoResposta eq 'SE'}" styleClass="mr5" disabled="#{disabled}" update="#{id}, panelDadosPergunta, #{id}_listaResposta, #{id}_checkMarc" process="@this" action="#{bean.validarDadosListaResposta(perguntaItens, respostaItens)}">
								<h:panelGroup style="color: black;" styleClass="#{respostaItens.selecionado ? 'fas fa-check-circle fs14  ': 'far fa-circle fs14  '}"></h:panelGroup>
							</p:commandLink>
						</h:panelGroup>
						<h:panelGroup id="editorFinish" styleClass="panelDescricaoEscolha">
							<h:outputText style="color: black;" escape="false" value="#{respostaItens.respostaPerguntaVO.descricao}" />
						</h:panelGroup>
						<h:panelGroup layout="block" styleClass="col-md-12 pn">
							<h:inputText size="20" rendered="#{respostaItens.selecionado and respostaItens.respostaPerguntaVO.apresentarRespostaAdicional}" maxlength="250" styleClass="form-control campos" value="#{respostaItens.respostaAdicional}" >
								<p:ajax event="blur" execute="@this" />
							</h:inputText>
						</h:panelGroup>
					</h:panelGroup>
				</ui:repeat>
				<ui:repeat id="#{id}_listaResposta2" var="respostaItens" value="#{perguntaItens.respostaPerguntaRespostaOrigemVOs}" rendered="#{(perguntaItens.perguntaVO.tipoRespostaMultiplaEscolha or perguntaItens.perguntaVO.tipoRespostaSimplesEscolha) and !perguntaItens.perguntaVO.layoutHorizontal and rendered}">
					<h:panelGroup layout="block" styleClass="rowIcon p5">
						<h:panelGroup styleClass="panelBooleans">
							<p:commandLink id="#{id}_checkDes2" rendered="#{perguntaItens.perguntaVO.tipoResposta eq 'ME'}" styleClass="mr5" disabled="#{disabled}" update="#{id}, panelDadosPergunta, #{id}_listaResposta2, #{id}_checkDes2" process="@this" action="#{bean.validarDadosListaResposta(perguntaItens, respostaItens)}">
								<h:panelGroup styleClass="#{respostaItens.selecionado ? 'fas fa-check-square fs14 ': 'far fa-square fs14   '}"></h:panelGroup>
							</p:commandLink>
							<p:commandLink id="#{id}_checkMarc2" rendered="#{perguntaItens.perguntaVO.tipoResposta eq 'SE'}" styleClass="mr5" disabled="#{disabled}" update="#{id}, panelDadosPergunta, #{id}_listaResposta2, #{id}_checkMarc2" process="@this" action="#{bean.validarDadosListaResposta(perguntaItens, respostaItens)}">
								<h:panelGroup styleClass="#{respostaItens.selecionado ? 'fas fa-check-circle fs14  ': 'far fa-circle fs14  '}"></h:panelGroup>
							</p:commandLink>
						</h:panelGroup>
						<h:panelGroup styleClass="panelDescricaoEscolha">
							<h:outputText style="color: black;" escape="false" value="#{respostaItens.respostaPerguntaVO.descricao}" />
						</h:panelGroup>
						<h:panelGroup layout="block" styleClass="col-md-12 pn">
							<h:inputText size="20" rendered="#{respostaItens.selecionado and respostaItens.respostaPerguntaVO.apresentarRespostaAdicional}" maxlength="250" styleClass="form-control campos" value="#{respostaItens.respostaAdicional}" >
								<p:ajax event="blur" execute="@this" />
							</h:inputText>
						</h:panelGroup>
					</h:panelGroup>
				</ui:repeat>
			</p:fragment>
			<h:panelGroup layout="block" styleClass="col-md-12" rendered="#{perguntaItens.perguntaVO.tipoRespostaTextual and rendered}">
				<h:inputTextarea styleClass="#{respostaObrigatoria ? 'form-control camposObrigatorios' : 'form-control'}" value="#{perguntaItens.texto}" readonly="#{disabled}" />
			</h:panelGroup>
			<h:panelGroup layout="block" styleClass="col-md-12 " rendered="#{perguntaItens.perguntaVO.tipoRespostaNumerico and rendered}">
				<h:panelGroup layout="block" styleClass="col-md-3 pn">
					<h:inputText id="pergNumero" size="20" rendered="#{perguntaItens.perguntaVO.tipoRespostaNumerico and rendered}" onkeydown="aceitarSomenteValorDecimal(this)" disabled="#{disabled}" maxlength="20" styleClass="#{respostaObrigatoria ? 'form-control camposObrigatorios' : 'form-control campos'}" value="#{perguntaItens.numerico}">
						<f:converter converterId="FormatadorNumerico" />
						<f:attribute name="quantidadeCasasDecimaisPermitirAposVirgula" value="#{perguntaItens.perguntaVO.quantidadeCasasDecimais}"></f:attribute>
						<f:attribute name="quantidadeMinimaCasasDecimaisPermitirAposVirgula" value="#{perguntaItens.perguntaVO.quantidadeCasasDecimais}"></f:attribute>
<!-- 						<p:ajax process="@this" update="@this" /> -->
					</h:inputText>
				</h:panelGroup>
			</h:panelGroup>
			<h:panelGroup layout="block" styleClass="col-md-12" rendered="#{perguntaItens.perguntaVO.tipoRespostaData and rendered}">
				<h:panelGroup layout="block" styleClass="col-md-2 h36 pn">
					<otm:calendar id="pergData" value="#{perguntaItens.data}" rendered="#{perguntaItens.perguntaVO.tipoRespostaData and rendered}" />
				</h:panelGroup>
			</h:panelGroup>
			<h:panelGroup layout="block" styleClass="col-md-12  mb5 pb5" rendered="#{perguntaItens.perguntaVO.tipoRespostaHora and rendered}">
				<h:panelGroup layout="block" styleClass="col-md-2 pn">
					<h:inputText id="pergHora" size="20" rendered="#{perguntaItens.perguntaVO.tipoRespostaHora and rendered}" disabled="#{disabled}" onkeypress="return mascara(this.form, this.id, '#{perguntaItens.perguntaVO.mascaraHoraApresentar}', event);" maxlength="20" styleClass="#{respostaObrigatoria ? 'form-control camposObrigatorios' : 'form-control campos'}" value="#{perguntaItens.hora}">
					</h:inputText>
				</h:panelGroup>
			</h:panelGroup>
			<h:panelGroup layout="block" styleClass="col-md-12 " rendered="#{perguntaItens.perguntaVO.tipoRespostaListaSuspensa and rendered}">
				<h:selectOneMenu id="pergListaSuspensa" styleClass="#{respostaObrigatoria ? 'camposObrigatorios' : 'campos'} form-control" disabled="#{disabled}" rendered="#{perguntaItens.perguntaVO.tipoRespostaListaSuspensa and rendered}" value="#{perguntaItens.respostaPerguntaVO.codigo}">
					<f:selectItems value="#{perguntaItens.perguntaVO.respostaPerguntaVOs}" var="respostaPerguntaItem" itemLabel="#{respostaPerguntaItem.descricao}" itemValue="#{respostaPerguntaItem.codigo}" />
				</h:selectOneMenu>
			</h:panelGroup>
			<h:panelGroup layout="block" styleClass="col-md-12" id="pergVerdadeiroFalso" rendered="#{perguntaItens.perguntaVO.tipoRespostaVerdadeiroFalso and rendered}">
				<otm:selectBooleanCheckbox id="pergVerdadeiroFalsoId" value="#{perguntaItens.verdadeiroFalse}"></otm:selectBooleanCheckbox>
			</h:panelGroup>
		</h:panelGroup>

		<h:panelGroup layout="block" styleClass="col-md-12" id="panelChecklist" rendered="#{renderedChecklist and !empty perguntaItens.listaPerguntaChecklistOrigem}">
			<otm2:panel name="#{id}_panelChecklist_#{perguntaItens.codigo}" styleClass="border rounded " styleClassFooter="p5" stylePanel="width: 100% !important; margin-bottom: 10px !important; padding:10px !important;">
				<ui:define name="header">
					<h:outputText value="Checklist" />
				</ui:define>
				<ui:define name="body">
					<ui:repeat id="#{id}_listaChecklist" var="perguntaChecklistItens" value="#{perguntaItens.listaPerguntaChecklistOrigem}">
						<h:panelGroup layout="block" styleClass="#{perguntaItens.cssColunaPerguntaChecklistOrigem}">
							<h:panelGroup layout="block" styleClass="row" style="text-align:left;">
								<h:outputText value="#{perguntaChecklistItens.perguntaChecklistVO.descricao}" style="font-size: 12px !important;" />
								<otm:selectBooleanCheckbox id="#{id}_checklist" value="#{perguntaChecklistItens.checklist}" disabled="#{desabilitarRespostaChecklist}" />
							</h:panelGroup>
						</h:panelGroup>
					</ui:repeat>
				</ui:define>
			</otm2:panel>
		</h:panelGroup>

		<h:panelGroup layout="block" styleClass="col-md-12" rendered="#{perguntaItens.perguntaVO.tipoResposta eq 'UP' and perguntaItens.perguntaVO.uploadMultiplo}">
			<otm2:panel name="nameAnexoArquivoUpload_#{perguntaItens.perguntaVO.codigo}" styleClass="border rounded " styleClassFooter="pn">
				<ui:define name="header">
					<h:panelGroup layout="block" styleClass="col-md-12" rendered="#{renderedAnexoPergunta}">
						<p:fileUpload event="uploadcomplete"
									  update="panelDadosPergunta"
									  process="@form"
									  id="btnUploadAnexo"
									  style="float: left;"
									  listHeight="100"
									  styleClass="btnUpload"
									  listWidth="300"
									  allowFlash="false"
									  noDuplicate="true"
									  fileUploadListener="#{bean.uploadAnexoArquivoPergunta}"
									  addLabel="Selecionar Anexo"
									  acceptedTypes="#{perguntaItens.perguntaVO.extensaoTipoResposta}"
									  cancelEntryControlLabel="Cancelar"
									  doneLabel="Pronto"
									  sizeErrorLabel="Arquivo não Enviado. Tamanho Máximo Permitido #{bean.configuracaoGeralPadraoSistema.tamanhoMaximoUpload}MB."
									  progressLabel="Enviando"
									  stopControlLabel="Parar"
									  uploadControlLabel="Enviar"
									  clearAllControlLabel="Limpar lista"
									  transferErrorLabel="Falha de Transmissão"
									  stopEntryControlLabel="Parar"
									  immediateUpload="true"
									  clearLabel=""
									  ontyperejected="alert('Arquivo não Enviado. Formato inválido do arquivo.');">
						</p:fileUpload>
					</h:panelGroup>
					<h:panelGroup layout="block" styleClass="col-md-12" rendered="#{!renderedAnexoPergunta}">
						<h:outputText value="Lista de Anexos"></h:outputText>
					</h:panelGroup>
				</ui:define>
				<ui:define name="body">
					<h:panelGroup layout="block" styleClass="col-md-12">
						<p:dataGrid rowKeyVar="row" id="listaAnexosArquivos" value="#{perguntaItens.listaArquivoVOs}" var="imagemItens" columns="5" elements="#{5}" border="0">
							<h:panelGroup layout="block" styleClass="col-md-12 mt3">
								<otm2:panel name="panelListaAnexosArquivo_#{row+1}" renderedControl="false" styleClassFooter="dn">
									<ui:define name="header">
										<h:outputText styleClass="tituloCamposResultado fs12" value="#{row+1}ª #{imagemItens.descricaoArquivo}" />
										<h:panelGroup layout="block" style="float: right">
											<p:commandLink action="#{bean.removerAnexoArquivoPergunta}" title="Excluir Anexo" rendered="#{renderedAnexoPergunta}" update="panelDadosPergunta" process="@form">
												<span class="far fa-trash-alt" style="margin-right: 0.8em; position: relative; top: 3px; font-size: 14px;"> </span>
											</p:commandLink>
										</h:panelGroup>
									</ui:define>
									<ui:define name="body">
										<h:panelGroup layout="block" styleClass="col-md-12 text-center">
											<h:graphicImage id="imgArquivo" url="#{imagemItens.descricao}" width="154" height="90px">
												<p:tooltip target="listaAnexosArquivos:imgArquivo" styleClass="tooltipRich text-left" followMouse="false" direction="bottomLeft" horizontalOffset="-10" verticalOffset="20" showDelay="0" style="z-index:10000;float: left">
													<h:graphicImage id="imgArquivo2" url="#{imagemItens.descricao}" style="width: auto; height: auto; max-width: 500px; max-height: 500px">
													</h:graphicImage>
												</p:tooltip>
											</h:graphicImage>
										</h:panelGroup>
									</ui:define>
								</otm2:panel>
							</h:panelGroup>
						</p:dataGrid>
					</h:panelGroup>
				</ui:define>
				<ui:define name="footer">
				</ui:define>
			</otm2:panel>
		</h:panelGroup>

		<h:panelGroup layout="block" styleClass="col-md-12" rendered="#{perguntaItens.perguntaVO.tipoResposta eq 'UP' and !perguntaItens.perguntaVO.uploadMultiplo}">
					<h:panelGroup styleClass="col-md-12 #{empty perguntaItens.arquivoVO.nome ? 'd-block' : 'd-none'}">
						<h:panelGroup layout="block" styleClass="col-md-12">
							<p:fileUpload event="uploadcomplete"
										  update="panelDadosPergunta"
										  process="@form"
										  id="btnUploadAnexoUnico"
										  style="float: left;"
										  listHeight="100"
										  styleClass="btnUpload"
										  listWidth="300"
										  allowFlash="false"
										  noDuplicate="true"
										  fileUploadListener="#{bean.uploadAnexoArquivoPergunta}"
										  addLabel="Selecionar Anexo"
										  acceptedTypes="#{perguntaItens.perguntaVO.extensaoTipoResposta}"
										  cancelEntryControlLabel="Cancelar"
										  doneLabel="Pronto"
										  sizeErrorLabel="Arquivo não Enviado. Tamanho Máximo Permitido #{bean.configuracaoGeralPadraoSistema.tamanhoMaximoUpload}MB."
										  progressLabel="Enviando"
										  stopControlLabel="Parar"
										  uploadControlLabel="Enviar"
										  clearAllControlLabel="Limpar lista"
										  transferErrorLabel="Falha de Transmissão"
										  stopEntryControlLabel="Parar"
										  immediateUpload="true"
										  clearLabel=""
										  ontyperejected="alert('Arquivo não Enviado. Formato inválido do arquivo.');">
							</p:fileUpload>
						</h:panelGroup>
					</h:panelGroup>
					<h:panelGroup layout="block" styleClass="row" rendered="#{!empty perguntaItens.arquivoVO.nome}" style="border: 1px #d4cFc7 dashed !important" update="panelDadosPergunta" >
						<h:panelGroup layout="block" styleClass="col-md-12 text-center m5">
							<h:panelGroup layout="block" styleClass="col-md-12 title" style="border: none!important; margin: 0!important;">
								<h:outputText styleClass="field control-label tituloCampos mr10" id="nomeAnexo" value="Nome do Arquivo: #{perguntaItens.arquivoVO.nome}"/>
								<p:commandLink update="panelPreviewGeral, panelPreview" rendered="#{!empty perguntaItens.arquivoVO.nome}" oncomplete="PF('panelPreview').show()" id="visualizarAnexo" action="#{bean.visualizarArquivoPergunta}">
									<span class="#{msg_botoes.btn_icon_verificar_embutido}"></span>
									<p:tooltip value="Visualizar Arquivo"></p:tooltip>
								</p:commandLink>
								<p:commandLink update="panelDadosPergunta" rendered="#{!empty perguntaItens.arquivoVO.nome}" oncomplete="#{bean.urlDonloadSV}" id="downloadAnexo" action="#{bean.downloadAnexoArquivoPergunta}">
									<span class="#{msg_botoes.btn_icon_download_embutido}"></span>
									<p:tooltip value="Download do Arquivo"></p:tooltip>
								</p:commandLink>
								<p:commandLink update="panelDadosPergunta" rendered="#{!empty perguntaItens.arquivoVO.nome and permiteDeletarArquivo}" id="removerAnexo" action="#{bean.removerAnexoArquivoPergunta}">
									<span class="#{msg_botoes.btn_icon_remover_embutido}"></span>
									<p:tooltip value="Remover Arquivo"></p:tooltip>
								</p:commandLink>
							</h:panelGroup>
						</h:panelGroup>
					</h:panelGroup>
		</h:panelGroup>	
	</h:panelGroup>
</ui:component>
</html>
